/*! Crocodoc Viewer - v0.10.8 | (c) 2015 Box */

//! moment.js
//! version : 2.10.6
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com

define("pointer",["require","jquery","log"],function(e){function u(e,t,n,r){var i=e.getGeometry(),s=i.page_width/t.page_width,o=(t.viewport_width-t.page_width)/2,u=(i.viewport_width-i.page_width)/2,a=u/o;if(n<o)return{x:n*a,y:r*s};if(n>=o&&n<=t.viewport_width-o)return{x:u+(n-o)*s,y:r*s};if(n>o+t.page_width)return{x:u+i.page_width+(n-o-t.page_width)*a,y:r*s}}function a(e,t){i.send_info("*",e,t,0)}function l(e){if(!s){n.error('stray event "stateupdatehandler" called - no circlediv assigned yet');return}switch(e.state){case"show":s.addClass("pointer-show");break;case"hide":s.removeClass("pointer-show ripple");break;case"click":f&&(clearTimeout(f),f=null),s.removeClass("pointer-show ripple").addClass("ripple"),f=setTimeout(function(){s.removeClass("ripple")},700)}}function c(){}function h(e){return e.clientX-t(e.currentTarget).offset().left}function p(e){return e.clientY-t(e.currentTarget).offset().top}function d(e){var r=t(e.currentTarget),i=r.attr("data-uuid"),s=o[i].viewer;if(!s){n.error("viewer null: no mapping for uuid = "+i+". aborting.");return}var u=s.getGeometry();if(!u){n.error("viewer.getGeometry() returned null ! aborting");return}var f={x:h(e),y:p(e),geometry:u,uuid:i,ev_type:"pointer-moved"};a("pointer-event",f)}function v(e){var r=t(e.currentTarget),i=r.attr("data-uuid"),s=o[i].viewer;if(!s){n.error("viewer null: no mapping for uuid = "+i+". aborting.");return}var u=s.getGeometry();if(!u){n.error("viewer.getGeometry() returned null ! aborting");return}var f={x:h(e),y:p(e),uuid:i,geometry:u,ev_type:"pointer-clicked"};a("pointer-event",f)}function m(e){var r=t(e.currentTarget),i=r.attr("data-uuid"),s=o[i].viewer;if(!s){n.error("viewer null: no mapping for uuid = "+i+". aborting.");return}var u=s.getGeometry();if(!u){n.error("viewer.getGeometry() returned null ! aborting");return}var f={x:h(e),y:p(e),uuid:i,geometry:u,ev_type:"pointer-leave"};a("pointer-event",f)}function g(e){var r=t(e.currentTarget),i=r.attr("data-uuid"),s=o[i].viewer;if(!s){n.error("handle_mouseenter_on_content: viewer null: no mapping for uuid = "+i+". aborting.");return}var u=s.getGeometry();if(!u){n.error("viewer.getGeometry() returned null ! aborting");return}var f={x:h(e),y:p(e),uuid:i,geometry:u,ev_type:"pointer-enter"};a("pointer-event",f)}function y(e,t){if(!s){n.error('stray event "handle_remote_pointer_moved" called - no circlediv assigned yet');return}if(typeof e!="undefined"){s.css("left",e),s.css("top",t);if(!s.hasClass("pointer-show")){var r={state:"show"};l(r)}}}function b(e,t,n,r){if(typeof e!="undefined"){var i={state:"click",x:e,y:t,w:n,h:r};l(i)}}function w(){var e={state:"hide"};l(e)}function E(){var e={state:"show"};l(e)}function S(e){e.on("mousemove",function(e){d(e)}),e.on("click",function(e){v(e)}),e.on("mouseleave",function(e){m(e)}),e.on("mouseenter",function(e){g(e)})}function x(e){e.off("mousemove",function(e){d(e)}),e.off("click",function(e){v(e)}),e.off("mouseleave",function(e){m(e)}),e.off("mouseenter",function(e){g(e)})}var t=e("jquery"),n=e("log")("content-pointer","info"),r={},i,s,o={};r.init=function(e){i=e},r.register=function(e,r,u){if(!e){n.error("null viewer ! aborting register.");return}var a=i.tabs.get_by_uuid(r)||{},f=a.handle;if(!f){n.error("pointer cant be added on non-existent tab : uuid = "+r);return}var l=t(f.anchor).find(".content-player-outer");o[r]={viewer:e,$anchor:l},u?(l.append('<div class="remote-cursor"></div>'),s=l.find(".remote-cursor")):S(l)},r.nowshowing=function(e){var t=i.tabs.get_by_uuid(e)||{},r=t.handle;r||n.error("pointer cant be added on non-existent tab : uuid = "+e);var u=o[e];if(!u){n.error("no mapping for uuid = "+e+". aborting.");return}var a=u.$anchor;s=a.find(".remote-cursor")},r.destroy=function(e,t,n){},r.info=function(e){if(!i.tabs.is_active(e.uuid)){n.error('pointer event rx for inactive tab (uuid="'+e.uuid+'"). ignoring.');return}var t=i.tabs.get_by_uuid(e.uuid),r=t.handle;if(!r){n.error("pointer moved for non-existent tab : uuid = "+e.uuid);return}var s=o[e.uuid];if(!s){n.error("something wrong happened: no map entry instance for uuid = "+e.uuid+". aborting.");return}var a=e.ev_type,f=s.$anchor,l=s.viewer,c=u(l,e.geometry,e.x,e.y);switch(a){case"pointer-moved":return y(c.x,c.y);case"pointer-clicked":return b(c.x,c.y,f.width,f.height);case"pointer-leave":return w();case"pointer-enter":return E()}};var f;return r}),!function(e){"use strict";e.Crocodoc=function(e){return"object"!=typeof exports?e(jQuery):void (module.exports=e)}(function(t){function n(){e.loadSVG=function(t){var n=new e.DOMParser,r=n.parseFromString(t,"image/svg+xml"),i=document.importNode(r.documentElement,!0);i.setAttribute("width","100%"),i.setAttribute("height","100%"),document.body?document.body.appendChild(i):document.documentElement.appendChild(i)}}var r="crocodoc-",i="data-svg-version",s=r+"viewer",o=r+"doc",u=r+"viewport",f=r+"viewer-logo",l=r+"draggable",c=r+"dragging",h=r+"text-selected",p=r+"text-disabled",d=r+"links-disabled",v=r+"mobile",m=r+"ielt9",g=r+"supports-svg",y=r+"window-as-viewport",b=r+"layout-",w=r+"current-page",E=r+"preceding-page",S=r+"page",x=S+"-inner",T=S+"-content",N=S+"-svg",C=S+"-text",k=S+"-link",L=S+"-links",A=S+"-autoscale",O=S+"-loading",M=S+"-error",_=S+"-visible",A=S+"-autoscale",D=S+"-prev",P=S+"-next",H=S+"-before",B=S+"-after",j=S+"-before-buffer",F=S+"-after-buffer",I=[P,B,D,H,j,F].join(" "),q='<div tabindex="-1" class="'+u+'"><div class="'+o+'"></div></div><div class="'+f+'"></div>',R='<div class="'+S+" "+O+'" style="width:{{w}}px; height:{{h}}px;" data-width="{{w}}" data-height="{{h}}"><div class="'+x+'"><div class="'+T+'"><div class="'+N+'"></div><div class="'+A+'"><div class="'+C+'"></div><div class="'+L+'"></div></div></div></div></div>',U=1024,z="fitwidth",W="fitheight",X="auto",V="in",$="out",J="previous",K="next",Q="vertical",G="vertical-single-column",Y="horizontal",Z="presentation",et="presentation-two-page",tt="text",nt="converting",rt="not loaded",it="loading",st="loaded",ot="error",ut="padding-",at=ut+"top",ft=ut+"right",lt=ut+"left",ct=ut+"bottom",ht=.95,pt=.99,dt=100,vt=32,mt=8,gt=1e3,yt="image/svg+xml",bt="<style>html,body{width:100%;height:100%;margin:0;overflow:hidden;}</style>",wt='<svg version="1.1" xmlns="http://www.w3.org/2000/svg"><script><![CDATA[('+n+")()]]></script></svg>",Et=1,St=2,xt=3,Tt=4,Nt=5,Ct=6,kt=7,Lt=8;if("undefined"==typeof t)throw new Error("jQuery is required");var At=function(){function e(n,r,i){var s;for(i=i||n,s=0;s<r.length;++s){if(n===r[s])throw new Error("Circular dependency detected: "+i+"->"+r[s]);t[r[s]]&&e(n,t[r[s]].mixins,i+"->"+r[s])}}var t={},n={};return{ZOOM_FIT_WIDTH:z,ZOOM_FIT_HEIGHT:W,ZOOM_AUTO:X,ZOOM_IN:V,ZOOM_OUT:$,SCROLL_PREVIOUS:J,SCROLL_NEXT:K,LAYOUT_VERTICAL:Q,LAYOUT_VERTICAL_SINGLE_COLUMN:G,LAYOUT_HORIZONTAL:Y,LAYOUT_PRESENTATION:Z,LAYOUT_PRESENTATION_TWO_PAGE:et,LAYOUT_TEXT:tt,ASSET_REQUEST_RETRIES:1,viewerTemplate:q,pageTemplate:R,components:t,utilities:n,createViewer:function(e,t){return new At.Viewer(e,t)},getViewer:function(e){return At.Viewer.get(e)},addComponent:function(n,r,i){r instanceof Function&&(i=r,r=[]),e(n,r),t[n]={mixins:r,creator:i}},createComponent:function(e,n){var r=t[e];if(r){for(var i=[],s=0;s<r.mixins.length;++s)i.push(this.createComponent(r.mixins[s],n));return i.unshift(n),r.creator.apply(r.creator,i)}return null},addPlugin:function(e,t){this.addComponent("plugin-"+e,t)},addDataProvider:function(e,t){this.addComponent("data-provider-"+e,t)},addUtility:function(e,t){n[e]={creator:t,instance:null}},getUtility:function(e){var t=n[e];return t?(t.instance||(t.instance=t.creator(this)),t.instance):null}}}();return function(){At.Scope=function(e){function n(e,t){var n,r,i,u;for(n=0,r=o.length;r>n;++n)i=o[n],i&&(u=i.messages||[],-1!==s.inArray(e,u)&&s.isFn(i.onmessage)&&i.onmessage.call(i,e,t))}function r(){for(var e;u.length;)e=u.shift(),n(e.name,e.data);u=null}function i(e){s.isFn(e.destroy)&&!e._destroyed&&(e.destroy(),e._destroyed=!0)}var s=At.getUtility("common"),o=[],u=[],a={},f=!1;e.dataProviders=e.dataProviders||{},this.createComponent=function(e){var t=At.createComponent(e,this);return t&&(t.componentName=e,o.push(t)),t},this.destroyComponent=function(e){var t,n;for(t=0,n=o.length;n>t;++t)if(e===o[t]){i(e),o.splice(t,1);break}},this.destroy=function(){var e,t,n,r=o.slice();for(e=0,t=r.length;t>e;++e)n=r[e],i(n);o=[],a={}},this.broadcast=function(e,t){f?n(e,t):u.push({name:e,data:t})},this.getUtility=function(e){return At.getUtility(e)},this.getConfig=function(){return e},this.ready=function(){f||(f=!0,r())},this.get=function(n,r){var i=e.dataProviders[n]||n,s=this.getDataProvider(i);return s?s.get(n,r):t.Deferred().reject("data-provider not found").promise()},this.getDataProvider=function(e){var t;return a[e]?t=a[e]:(t=this.createComponent("data-provider-"+e),a[e]=t),t}}}(),function(){function e(e,t){var n=!1;return{type:e,data:t,preventDefault:function(){n=!0},isDefaultPrevented:function(){return n}}}At.EventTarget=function(){this._handlers={}},At.EventTarget.prototype={constructor:At.EventTarget,on:function(e,t){"undefined"==typeof this._handlers[e]&&(this._handlers[e]=[]),this._handlers[e].push(t)},fire:function(t,n){var r,i,s,o=e(t,n);if(r=this._handlers[o.type],r instanceof Array)for(r=r.concat(),i=0,s=r.length;s>i;i++)r[i]&&r[i].call(this,o);if(r=this._handlers.all,r instanceof Array)for(r=r.concat(),i=0,s=r.length;s>i;i++)r[i]&&r[i].call(this,o);return o},off:function(e,t){var n,r,i=this._handlers[e];if(i instanceof Array){if(!t)return void (i.length=0);for(n=0,r=i.length;r>n;n++)if(i[n]===t||i[n].handler===t){i.splice(n,1);break}}},one:function(e,t){var n=this,r=function(i){n.off(e,r),t.call(n,i)};r.handler=t,this.on(e,r)}}}(),function(){var e=0,n={};At.Viewer=function(r,i){function s(){h.init()}At.EventTarget.call(this);var o,u=At.getUtility("common"),f=t(r),l=u.extend(!0,{},At.Viewer.defaults,i),c=new At.Scope(l),h=c.createComponent("viewer-base");if(0===f.length)throw new Error("Invalid container element");this.id=l.id=++e,l.api=this,l.$el=f,n[this.id]=this,this.destroy=function(){delete n[l.id],c.broadcast("destroy"),c.destroy()},this.load=function(){h.loadAssets()},this.setLayout=function(e){o=null,o=h.setLayout(e)},this.zoom=function(e){var t=parseFloat(e);o&&(t&&(e=t/(l.pageScale||1)),o.setZoom(e))},this.scrollTo=function(e){o&&u.isFn(o.scrollTo)&&o.scrollTo(e)},this.scrollBy=function(e,t){o&&o.scrollBy(e,t)},this.focus=function(){o&&o.focus()},this.enableTextSelection=function(){f.toggleClass(p,!1),l.enableTextSelection||(l.enableTextSelection=!0,c.broadcast("textenabledchange",{enabled:!0}))},this.disableTextSelection=function(){f.toggleClass(p,!0),l.enableTextSelection&&(l.enableTextSelection=!1,c.broadcast("textenabledchange",{enabled:!1}))},this.enableLinks=function(){l.enableLinks||(f.removeClass(d),l.enableLinks=!0)},this.disableLinks=function(){l.enableLinks&&(f.addClass(d),l.enableLinks=!1)},this.updateLayout=function(){o&&o.update()},s()},At.Viewer.prototype=new At.EventTarget,At.Viewer.prototype.constructor=At.Viewer,At.Viewer.get=function(e){return n[e]},At.Viewer.defaults={url:null,layout:Q,zoom:X,page:1,enableTextSelection:!0,enableLinks:!0,enableDragging:!1,queryParams:null,plugins:{},useWindowAsViewport:!1,conversionIsComplete:!0,template:{svg:"page-{{page}}.svg",img:"page-{{page}}.png",html:"text-{{page}}.html",css:"stylesheet.css",json:"info.json"},dataProviders:{metadata:"metadata",stylesheet:"stylesheet","page-svg":"page-svg","page-text":"page-text","page-img":"page-img"},pageStart:null,pageEnd:null,autoloadFirstPage:!0,zoomLevels:[.25,.5,.75,1,1.25,1.5,2,3]}}(),At.addDataProvider("metadata",function(e){function t(e){return r.parseJSON(e)}var n=e.getUtility("ajax"),r=e.getUtility("common"),i=e.getConfig();return{get:function(){var e=this.getURL(),r=n.fetch(e,At.ASSET_REQUEST_RETRIES);return r.then(t).promise({abort:r.abort})},getURL:function(){var e=i.template.json;return i.url+e+i.queryString}}}),At.addDataProvider("page-img",function(e){var n=e.getUtility("common"),r=e.getConfig();return{get:function(e,n){function r(){s.setAttribute("src",a)}function i(){s&&s.removeAttribute("src")}var s=this.getImage(),o=At.ASSET_REQUEST_RETRIES,u=!1,a=this.getURL(n),f=t.Deferred();return s.onload=function(){u=!0,f.resolve(s)},s.onerror=function(){o>0?(o--,i(),r()):(s=null,u=!1,f.reject({error:"image failed to load",resource:a}))},r(),f.promise({abort:function(){u||(i(),f.reject())}})},getURL:function(e){var t=n.template(r.template.img,{page:e});return r.url+t+r.queryString},getImage:function(){return new Image}}}),At.addDataProvider("page-svg",function(e){function t(e,t){var n="<style>"+t+"</style>";return o.firefox&&!u.isSubpxSupported()&&(n+="<style>text { text-rendering: geometricPrecision; }</style>"),e=e.replace(c,n)}function n(n){if(!f){var s,o=a.queryString.replace("&","&#38;");return s=i.countInStr(n,'xlink:href="data:image'),s>r&&(n=n.replace(/<image[\s\w-_="]*xlink:href="data:image\/[^"]{0,5120}"[^>]*>/gi,"")),n=n.replace(/href="([^"#:]*)"/g,function(e,t){return'href="'+a.url+t+o+'"'}),e.get("stylesheet").then(function(e){return t(n,e)})}}var r=1e3,i=e.getUtility("common"),s=e.getUtility("ajax"),o=e.getUtility("browser"),u=e.getUtility("subpx"),a=e.getConfig(),f=!1,l={},c=/<xhtml:link[^>]*>(\s*<\/xhtml:link>)?/i;return{get:function(e,t){var r,i=this.getURL(t);return l[t]?l[t]:(r=s.fetch(i,At.ASSET_REQUEST_RETRIES),l[t]=r.then(n).promise({abort:function(){r.abort(),l&&delete l[t]}}),l[t])},getURL:function(e){var t=i.template(a.template.svg,{page:e});return a.url+t+a.queryString},destroy:function(){f=!0,i=s=u=o=a=l=null}}}),At.addDataProvider("page-text",function(e){function t(e){if(!o){var t=r.countInStr(e,"<div");return t>n?"":e=e.replace(/<link rel="stylesheet".*/,"")}}var n=256,r=e.getUtility("common"),i=e.getUtility("ajax"),s=e.getConfig(),o=!1,u={};return{get:function(e,n){var r,s=this.getURL(n);return u[n]?u[n]:(r=i.fetch(s,At.ASSET_REQUEST_RETRIES),u[n]=r.then(t).promise({abort:function(){r.abort(),u&&delete u[n]}}),u[n])},getURL:function(e){var t=r.template(s.template.html,{page:e});return s.url+t+s.queryString},destroy:function(){o=!0,r=i=s=u=null}}}),At.addDataProvider("stylesheet",function(e){function t(e){return i.ie&&(e=e.replace(/font-family:[\s\"\']*([\w-]+)\b/g,"$0-"+s.id)),e}var n,r=e.getUtility("ajax"),i=e.getUtility("browser"),s=e.getConfig();return{get:function(){if(n)return n;var e=r.fetch(this.getURL(),At.ASSET_REQUEST_RETRIES);return n=e.then(t).promise({abort:function(){e.abort(),n=null}})},getURL:function(){var e=s.template.css;return s.url+e+s.queryString},destroy:function(){r=i=s=null,n=null}}}),At.addUtility("ajax",function(e){function n(e){var t,n,r;try{t=e.status,n=e.statusText,r=e.responseText}catch(i){t=0,n="",r=null}return{status:t,statusText:n,responseText:r,rawRequest:e}}function r(e){return"file:"===c.parse(e).protocol}function i(e){return e>=200&&300>e||304===e}function s(e){return e=f.extend(!0,{},e||{}),e.method=e.method||"GET",e.headers=e.headers||[],e.data=e.data||"","string"!=typeof e.data&&(e.data=t.param(e.data),"GET"!==e.method&&(e.data=e.data,e.headers.push(["Content-Type","application/x-www-form-urlencoded"]))),e}function o(e,t){var n;for(n=0;n<t.length;++n)e.setRequestHeader(t[n][0],t[n][1])}function u(e,t,n,s,u,a){var f=l.getXHR();return f.open(t,e,!0),f.onreadystatechange=function(){var t;if(4===f.readyState){f.onreadystatechange=function(){};try{t=f.status}catch(n){return void a(f)}0===t&&r(e)&&(t=200),i(t)?u(f):a(f)}},o(f,s),f.send(n),f}function a(e,t,n,r,i){var s=l.getXDR();try{s.open(t,e),s.onload=function(){r(s)},s.onerror=function(){i(s)},s.ontimeout=function(){i(s)},s.onprogress=function(){},s.send(n)}catch(o){return i({status:0,statusText:o.message})}return s}var f=e.getUtility("common"),l=e.getUtility("support"),c=e.getUtility("url");return{request:function(e,t){function r(e){return f.isFn(o.success)&&o.success.call(n(e)),e}function i(e){return f.isFn(o.fail)&&o.fail.call(n(e)),e}var o=s(t),h=o.method,p=o.data,d=o.headers;return"GET"===h&&p&&(e=c.appendQueryParams(e,p),p=""),l.isXHRSupported()?c.isCrossDomain(e)&&!l.isCORSSupported()?a(e,h,p,r,i):u(e,h,p,d,r,i):o.fail({status:0,statusText:"AJAX not supported"})},fetch:function(e,n){function r(e){n>0?(n--,s=i()):a.reject(e)}function i(){return u.request(e,{success:function(){var t,n;if(!o){if(n=this.rawRequest,202===this.status&&f.isFn(n.getResponseHeader)&&(t=parseInt(n.getResponseHeader("retry-after")),t>0))return void setTimeout(i,1e3*t);this.responseText?a.resolve(this.responseText):r({error:"empty response",status:this.status,resource:e})}},fail:function(){o||r({error:this.statusText,status:this.status,resource:e})}})}var s,o=!1,u=this,a=t.Deferred();return s=i(),a.promise({abort:function(){o=!0,s.abort()}})}}}),At.addUtility("browser",function(){var e,t=navigator.userAgent,n={},r=/ip(hone|od|ad)/i.test(t),i=/android/i.test(t),s=/blackberry/i.test(t),o=/webos/i.test(t),u=/silk|kindle/i.test(t),a=/MSIE|Trident/i.test(t);return a&&(n.ie=!0,e=/MSIE/i.test(t)?/MSIE\s+(\d+\.\d+)/i.exec(t):/Trident.*rv[ :](\d+\.\d+)/.exec(t),n.version=e&&parseFloat(e[1]),n.ielt9=n.version<9,n.ielt10=n.version<10,n.ielt11=n.version<11),r&&(n.ios=!0,e=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n.version=e&&parseFloat(e[1]+"."+e[2])),n.mobile=/mobile/i.test(t)||r||i||s||o||u,n.firefox=/firefox/i.test(t),/safari/i.test(t)&&(n.chrome=/chrome/i.test(t),n.safari=!n.chrome),n.safari&&(e=navigator.appVersion.match(/Version\/(\d+(\.\d+)?)/),n.version=e&&parseFloat(e[1])),n}),At.addUtility("common",function(){var n=1.33333,r={};return r.extend=t.extend,r.each=t.each,r.map=t.map,r.param=t.param,r.parseJSON=t.parseJSON,r.stringifyJSON="undefined"!=typeof e.JSON?e.JSON.stringify:function(){throw new Error("JSON.stringify not supported")},t.extend(r,{bisectLeft:function(e,t,n){for(var r,i,s=0,o=e.length;o>s;)i=Math.floor((s+o)/2),r=n?e[i][n]:e[i],t>r?s=i+1:o=i;return s},bisectRight:function(e,t,n){for(var r,i,s=0,o=e.length;o>s;)i=Math.floor((s+o)/2),r=n?e[i][n]:e[i],r>t?o=i:s=i+1;return s},clamp:function(e,t,n){return t>e?t:e>n?n:e},sign:function(e){var t=parseInt(e,10);return t?0>t?-1:1:t},isFn:function(e){return"function"==typeof e},inArray:function(e,n){return r.isFn(n.indexOf)?n.indexOf(e):t.inArray(e,n)},constrainRange:function(e,t,n){var i=t-e;return 0>i?{min:-1,max:-1}:(e=r.clamp(e,0,n),t=r.clamp(e+i,0,n),i>t-e&&(e=r.clamp(t-i,0,n)),{min:e,max:t})},now:function(){return(new Date).getTime()},throttle:function(e,t){function n(){a=r.now(),o=null,u=t.apply(i,s)}var i,s,o,u,a=0;return function(){var f=r.now(),l=e-(f-a);return i=this,s=arguments,0>=l?(clearTimeout(o),o=null,a=f,u=t.apply(i,s)):o||(o=setTimeout(n,l)),u}},debounce:function(e,t){function n(){var f=r.now()-u;e>f?o=setTimeout(n,e-f):(o=null,a=t.apply(i,s),i=s=null)}var i,s,o,u,a;return function(){return i=this,s=arguments,u=r.now(),o||(o=setTimeout(n,e)),a}},insertCSS:function(e){var t=document.createElement("style"),n=document.createTextNode(e);try{t.setAttribute("type","text/css"),t.appendChild(n)}catch(r){}return document.getElementsByTagName("head")[0].appendChild(t),t},appendCSSRule:function(e,t,n){var r;return e.insertRule?e.insertRule(t+"{"+n+"}",e.cssRules.length):(r=e.addRule(t,n,e.rules.length),0>r&&(r=e.rules.length-1),r)},deleteCSSRule:function(e,t){e.deleteRule?e.deleteRule(t):e.removeRule(t)},getSelectedNode:function(){var t,n,r;return e.getSelection?(n=e.getSelection(),n.rangeCount&&(r=n.getRangeAt(0),r.collapsed||(t=n.anchorNode.parentNode))):document.selection&&(t=document.selection.createRange().parentElement()),t},getComputedStyle:function(t){return"getComputedStyle"in e?e.getComputedStyle(t):t.currentStyle},calculatePtSize:function(){var e,t,i=1e4,s=document.createElement("div");return s.style.display="block",s.style.position="absolute",s.style.width=i+"pt",document.body.appendChild(s),e=r.getComputedStyle(s),t=e&&e.width?parseFloat(e.width)/i:n,document.body.removeChild(s),t},countInStr:function(e,t){for(var n,r=0;n=e.indexOf(t,n)+1;)r++;return r},template:function(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e=e.replace(new RegExp("\\{\\{"+n+"\\}\\}","g"),t[n]));return e}})}),At.addUtility("subpx",function(n){function r(){if(!t.support.leadingWhitespace)return!1;var n=t(o.template(s,{size:12.5})).appendTo(document.documentElement).get(0),r=t(n).css("font-size"),i=t(n).width();t(n).remove(),n=t(o.template(s,{size:12.6})).appendTo(document.documentElement).get(0);var u=t(n).css("font-size"),f=t(n).width();if(t(n).remove(),!("ontouchstart"in e)){if(r===u)return!1;if(i===f)return!1}return!0}var i="crocodoc-subpx-fix",s='<span style="font:{{size}}px serif; color:transparent; white-space:nowrap;">'+(new Array(100)).join("A")+"</span>",o=n.getUtility("common"),u=r();return{fix:function(e){if(!u&&void 0!==document.body.style.zoom){var n=t("<div>").addClass(i);t(e).wrap(n)}return e},isSubpxSupported:function(){return u}}}),At.addUtility("support",function(){function t(e){var t,i,s,o=document.createElement("div");if(e in o.style)return e;if(t=e.charAt(0).toUpperCase()+e.substr(1),e in o.style)return e;for(i=0;i<r.length;++i)if(s=r[i]+t,s in o.style)return 0===s.indexOf("ms")&&(s="-"+s),n(s);return!1}function n(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}var r=["Moz","Webkit","O","ms"],i=null,s=null;return{svg:document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),csstransform:t("transform"),csstransition:t("transition"),csszoom:t("zoom"),isXHRSupported:function(){return null===i&&(i=!!this.getXHR()),i},isCORSSupported:function(){return null===s&&(s=this.isXHRSupported()&&"withCredentials"in this.getXHR()),s},isXDRSupported:function(){return"undefined"!=typeof e.XDomainRequest},getXHR:function(){if(e.XMLHttpRequest)return new e.XMLHttpRequest;try{return new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(t){return null}},getXDR:function(){return this.isXDRSupported()?new e.XDomainRequest:null}}}),At.addUtility("url",function(t){var n,r=t.getUtility("browser");return{getCurrentURL:function(){return e.location.href},makeAbsolute:function(e){return this.parse(e).href},isCrossDomain:function(e){var t=this.parse(e);return n||(n=this.parse(this.getCurrentURL())),t.hostname?t.protocol!==n.protocol||t.hostname!==n.hostname||t.port!==n.port:!1},appendQueryParams:function(e,t){return e.indexOf("?")>-1?e+"&"+t:e+"?"+t},parse:function(e){var t,n=document.createElement("a");return n.href=e,r.ie&&e!==n.href&&(e=n.href,n.href=e),t=n.pathname,/^\//.test(t)||(t="/"+t),{href:n.href,protocol:n.protocol,host:n.host,hostname:n.hostname,port:n.port,pathname:t,hash:n.hash,search:n.search}}}}),At.addComponent("controller-paged",function(e){function n(){var e=f.metadata;f.numPages=e.numpages,f.pageStart?f.pageStart<0&&(f.pageStart=e.numpages+f.pageStart):f.pageStart=1,f.pageStart=p.clamp(f.pageStart,1,e.numpages),f.pageEnd?f.pageEnd<0&&(f.pageEnd=e.numpages+f.pageEnd):f.pageEnd=e.numpages,f.pageEnd=p.clamp(f.pageEnd,f.pageStart,e.numpages),f.numPages=f.pageEnd-f.pageStart+1}function r(){var e,n,r,i,s,o,u,a,l=p.calculatePtSize(),c=f.metadata.dimensions,h="";for(f.pageScale=U/(c.width*l),r=f.zoomLevels[f.zoomLevels.length-1],i=3/f.pageScale;i>r;)r+=r/2,f.zoomLevels.push(r);for(c.exceptions=c.exceptions||{},e=f.pageStart-1;e<f.pageEnd;e++)n=e+1,n in c.exceptions?(s=c.exceptions[n].width,o=c.exceptions[n].height):(s=c.width,o=c.height),u=s*l,a=o*l,u*=f.pageScale,a*=f.pageScale,h+=p.template(At.pageTemplate,{w:u,h:a});f.$pages=t(h).appendTo(f.$doc)}function i(e){return f.conversionIsComplete||0===e&&f.autoloadFirstPage?rt:nt}function s(){var t,n,r=[],s=f.pageStart-1,u=f.pageEnd,a=o();for(t=s;u>t;t++)n=e.createComponent("page"),n.init(f.$pages.eq(t-s),{index:t,status:i(t),enableLinks:f.enableLinks,links:a[t],pageScale:f.pageScale}),r.push(n);f.pages=r}function o(){var e,t,n,r,i=f.pageStart,s=f.pageEnd,o=f.metadata.links||[],u=[];for(e=0,t=f.metadata.numpages;t>e;++e)u[e]=[];for(e=0,t=o.length;t>e;++e)if(n=o[e],!(n.pagenum<i||n.pagenum>s)){if(n.destination){if(r=n.destination.pagenum,i>r||r>s)continue;n.destination.pagenum=r-(i-1)}u[n.pagenum-1].push(n)}return u}function u(){a()}function a(){var e=p.getSelectedNode(),n=t(e).closest("."+S);l.find("."+h).removeClass(h),e&&l.has(e)&&n.addClass(h)}var f,l,c,p=e.getUtility("common");return{init:function(){f=e.getConfig(),l=f.$el,t(document).on("mouseup",u),n(),r(),s(),c=e.createComponent("lazy-loader"),c.init(f.pages)},destroy:function(){t(document).off("mouseup",u)}}}),At.addComponent("controller-text",function(e){var n;return{init:function(){var r=e.getConfig();r.$textContainer=t(),n=e.get("page-text",1).then(function(e){var n=r.$doc.parent();r.$doc=t(e),n.html(r.$doc)})},destroy:function(){n.abort()}}}),At.addComponent("dragger",function(n){function r(e){o.scrollTop(u.top-(e.clientY-f.y)),o.scrollLeft(u.left-(e.clientX-f.x)),e.preventDefault()}function i(e){n.broadcast("dragend"),l.off("mousemove",r),l.off("mouseup",i),e.preventDefault()}function s(e){n.broadcast("dragstart"),u={top:o.scrollTop(),left:o.scrollLeft()},f={x:e.clientX,y:e.clientY},l.on("mousemove",r),l.on("mouseup",i),e.preventDefault()}var o,u,f,l=t(e);return{init:function(e){o=t(e),o.on("mousedown",s)},destroy:function(){o.off("mousedown",s),o.off("mousemove",r),l.off("mouseup",i)}}}),At.addComponent("layout-base",function(t){var n=t.getUtility("common");return{messages:["resize","scroll","scrollend"],onmessage:function(e,t){switch(e){case"resize":this.handleResize(t);break;case"scroll":this.handleScroll(t);break;case"scrollend":this.handleScrollEnd(t)}},init:function(){var e=t.getConfig();this.config=e,this.$el=e.$el,this.$doc=e.$doc,this.$viewport=e.$viewport,this.$pages=e.$pages,this.numPages=e.numPages,this.layoutClass=b+e.layout,this.$el.addClass(this.layoutClass),this.initState()},initState:function(){var t=this.$viewport[0],n=t;t===e&&(n=document.documentElement),this.state={scrollTop:t.scrollTop,scrollLeft:t.scrollLeft,viewportDimensions:{clientWidth:n.clientWidth,clientHeight:n.clientHeight,offsetWidth:n.offsetWidth,offsetHeight:n.offsetHeight},zoomState:{zoom:1,prevZoom:0,zoomMode:null},initialWidth:0,initialHeight:0,totalWidth:0,totalHeight:0},this.zoomLevels=[]},destroy:function(){this.$doc.removeAttr("style"),this.$el.removeClass(this.layoutClass)},setZoom:function(){},calculateNextZoomLevel:function(e){var t,n=!1,r=this.state.zoomState.zoom,i=this.zoomLevels;if(e===At.ZOOM_IN){for(t=0;t<i.length;++t)if(i[t]>r){n=i[t];break}}else if(e===At.ZOOM_OUT)for(t=i.length-1;t>=0;--t)if(i[t]<r){n=i[t];break}return n},isDraggable:function(){var e=this.state;return e.viewportDimensions.clientHeight<e.totalHeight||e.viewportDimensions.clientWidth<e.totalWidth},scrollBy:function(e,t){e=parseInt(e,10)||0,t=parseInt(t,10)||0,this.scrollToOffset(e+this.state.scrollLeft,t+this.state.scrollTop)},scrollToOffset:function(e,t){this.$viewport.scrollLeft(e),this.$viewport.scrollTop(t)},handleScroll:function(e){this.state.scrollTop=e.scrollTop,this.state.scrollLeft=e.scrollLeft},handleResize:function(){},handleScrollEnd:function(){},update:function(){},focus:function(){this.$viewport.focus()},extend:function(e){return n.extend({},this,e)}}}),At.addComponent("layout-"+Y,["layout-paged"],function(e,t){var n=e.getUtility("common"),r=e.getUtility("browser");return t.extend({calculateZoomAutoValue:function(){var e=this.state,t=this.calculateZoomValue(z),n=this.calculateZoomValue(W);return e.widestPage.actualWidth>e.tallestPage.actualHeight?Math.min(t,n):r.mobile?n:Math.min(1,n)},calculateCurrentPage:function(){var e,t,r=this.state,i=r.pages;return e=n.bisectRight(i,r.scrollLeft,"x0")-1,t=n.bisectRight(i,r.scrollLeft+i[e].width/2,"x0")-1,1+t},calculateNextPage:function(){return this.state.currentPage+1},calculatePreviousPage:function(){return this.state.currentPage-1},handleResize:function(e){t.handleResize.call(this,e),this.updateCurrentPage()},handleScroll:function(e){t.handleScroll.call(this,e),this.updateCurrentPage()},updateLayout:function(){var e=this.state,t=e.zoomState,n=t.zoom,r=e.sumWidths,i=Math.floor(e.tallestPage.totalActualHeight*n),s=Math.max(r,e.viewportDimensions.clientWidth),o=Math.max(i,e.viewportDimensions.clientHeight);this.$doc.css({height:o,lineHeight:o+"px",width:s})}})}),At.addComponent("layout-paged",["layout-base"],function(e,t){function n(e,t){var n,r,o,u,a=e.state,f="."+e.config.namespace+" ."+A,l=e.config.stylesheet,c=a.pages,h=t*e.config.pageScale,p=100/h;for(u=s.csstransform?s.csstransform+":scale("+h+");width:"+p+"%;height:"+p+"%;":s.csszoom?"zoom:"+h:"",a.previousStyleIndex&&i.deleteCSSRule(l,a.previousStyleIndex),a.previousStyleIndex=i.appendCSSRule(l,f,u),n=0,r=c.length;r>n;++n)o=c[n],e.$pages.eq(n).css({width:o.actualWidth*t,height:o.actualHeight*t,paddingTop:o.paddingTop*t,paddingRight:o.paddingRight*t,paddingBottom:o.paddingBottom*t,paddingLeft:o.paddingLeft*t})}function r(e,t){if(!t||0===t.length)return 1/0;var n=i.map(t,function(t){return e[t].y1});return Math.max.apply(Math,n)}var i=e.getUtility("common"),s=e.getUtility("support");return t.extend({init:function(){t.init.call(this),this.updatePageStates(),this.updateZoomLevels()},initState:function(){t.initState.call(this),i.extend(this.state,{pages:[],widestPage:{index:0,actualWidth:0},tallestPage:{index:0,actualHeight:0},sumWidths:0,sumHeights:0,rows:[],currentPage:null,visiblePages:[],fullyVisiblePages:[]})},destroy:function(){t.destroy.call(this),this.$pages.css("padding","")},update:function(){this.updatePageStates(!0),this.setZoom()},setZoom:function(t){var n,r,s=this.state,o=this.parseZoomValue(t),u=s.zoomState,f=u.zoom;n=this.calculateZoomMode(t,o),o=i.clamp(o,s.minZoom,s.maxZoom),e.broadcast("beforezoom",i.extend({page:s.currentPage,visiblePages:i.extend([],s.visiblePages),fullyVisiblePages:i.extend([],s.fullyVisiblePages)},u)),u.prevZoom=f,u.zoom=o,u.zoomMode=n,this.applyZoom(o),u.canZoomIn=this.calculateNextZoomLevel(At.ZOOM_IN)!==!1,u.canZoomOut=this.calculateNextZoomLevel(At.ZOOM_OUT)!==!1,this.updatePageStates(),this.updateLayout(),r=t===At.ZOOM_AUTO||t===At.ZOOM_FIT_WIDTH||t===At.ZOOM_FIT_HEIGHT,this.updateScrollPosition(r),this.updatePageStates(),this.updateVisiblePages(!0),e.broadcast("zoom",i.extend({page:s.currentPage,visiblePages:i.extend([],s.visiblePages),fullyVisiblePages:i.extend([],s.fullyVisiblePages),isDraggable:this.isDraggable()},u))},parseZoomValue:function(e){var t=parseFloat(e),n=this.state,r=n.zoomState,i=r.zoom,s=i;if(t)s=t;else switch(e){case At.ZOOM_FIT_WIDTH:case At.ZOOM_FIT_HEIGHT:case At.ZOOM_AUTO:s=this.calculateZoomValue(e);break;case At.ZOOM_IN:case At.ZOOM_OUT:s=this.calculateNextZoomLevel(e)||i;break;default:s=i?r.zoomMode?this.calculateZoomValue(r.zoomMode):i:this.calculateZoomValue(this.config.zoom||At.ZOOM_AUTO)}return s},calculateZoomMode:function(e,t){switch(t){case this.calculateZoomValue(At.ZOOM_AUTO):return"string"!=typeof e||e!==At.ZOOM_FIT_WIDTH&&e!==At.ZOOM_FIT_HEIGHT?At.ZOOM_AUTO:e;case this.calculateZoomValue(At.ZOOM_FIT_WIDTH):return At.ZOOM_FIT_WIDTH;case this.calculateZoomValue(At.ZOOM_FIT_HEIGHT):return At.ZOOM_FIT_HEIGHT;default:return null}},updateZoomLevels:function(){function e(e){var t=n/e;return e===n?!1:ht>t?!0:i.inArray(e,a)>-1&&pt>t?!0:!1}var t,n,r=this.config.zoomLevels.slice()||[1],s=this.calculateZoomValue(At.ZOOM_AUTO),o=this.calculateZoomValue(At.ZOOM_FIT_WIDTH),u=this.calculateZoomValue(At.ZOOM_FIT_HEIGHT),a=[o,u];for(this.state.minZoom=this.config.minZoom||r[0],this.state.maxZoom=this.config.maxZoom||r[r.length-1],s!==o&&s!==u&&a.push(s),r=r.concat(a),r.sort(function(e,t){return e-t}),this.zoomLevels=[],n=0,t=0;t<r.length;++t)e(r[t])&&(n=r[t],this.zoomLevels.push(n))},calculateZoomValue:function(e){var t=this.state,n=parseFloat(e);return n?n:e===At.ZOOM_FIT_WIDTH?t.viewportDimensions.clientWidth/t.widestPage.totalActualWidth:e===At.ZOOM_FIT_HEIGHT?t.viewportDimensions.clientHeight/t.tallestPage.totalActualHeight:e===At.ZOOM_AUTO?this.calculateZoomAutoValue():t.zoomState.zoom},applyZoom:function(e){n(this,e)},scrollTo:function(e){var t=this.state,n=parseInt(e,10);if("string"==typeof e){if(e===At.SCROLL_PREVIOUS&&t.currentPage>1)n=this.calculatePreviousPage();else if(e===At.SCROLL_NEXT&&t.currentPage<this.numPages)n=this.calculateNextPage();else if(!n)return}else if(!n&&0!==n)return;n=i.clamp(n,1,this.numPages),this.scrollToPage(n)},scrollToPage:function(e){var t=this.calculateScrollPositionForPage(e);this.scrollToOffset(t.left,t.top)},calculateCurrentPage:function(){return this.state.currentPage},calculateScrollPositionForPage:function(e){var t=i.clamp(e-1,0,this.numPages-1),n=this.state.pages[t];return{top:n.y0,left:n.x0}},calculateVisibleRange:function(){var e=this.state,t=e.pages,n=e.viewportDimensions.clientHeight,r=e.viewportDimensions.clientWidth;if(0===r||0===n)return{min:-1,max:-1};var s=e.scrollTop,o=s+n,u=e.scrollLeft,a=u+r,f=i.bisectLeft(t,s,"y1"),l=i.bisectRight(t,o,"y0")-1,c=i.bisectLeft(t,u,"x1"),h=i.bisectRight(t,a,"x0")-1,p=Math.max(c,f),d=Math.min(h,l);return i.constrainRange(p,d,this.numPages-1)},calculateFullyVisibleRange:function(){var e=this.state,t=e.pages,n=e.viewportDimensions.clientHeight,r=e.viewportDimensions.clientWidth;if(0===r||0===n)return{min:-1,max:-1};var s=e.scrollTop,o=s+n,u=e.scrollLeft,a=u+r,f=i.bisectLeft(t,s,"y0"),l=i.bisectRight(t,o,"y1")-1,c=i.bisectLeft(t,u,"x0"),h=i.bisectRight(t,a,"x1")-1,p=Math.max(c,f),d=Math.min(h,l);return i.constrainRange(p,d,this.numPages-1)},setCurrentPage:function(t){var n=this.state;n.currentPage!==t?(n.currentPage=t,this.updateVisiblePages(),e.broadcast("pagefocus",{page:n.currentPage,numPages:this.numPages,visiblePages:i.extend([],n.visiblePages),fullyVisiblePages:i.extend([],n.fullyVisiblePages)})):this.updateVisiblePages()},updateVisiblePages:function(e){var t,n,r,i=this.state,s=this.calculateVisibleRange(),o=this.calculateFullyVisibleRange();for(i.visiblePages.length=0,i.fullyVisiblePages.length=0,t=0,n=this.$pages.length;n>t;++t)r=this.$pages.eq(t),t<s.min||t>s.max?e&&r.hasClass(_)&&r.removeClass(_):(e&&!r.hasClass(_)&&r.addClass(_),i.visiblePages.push(t+1)),t>=o.min&&t<=o.max&&i.fullyVisiblePages.push(t+1)},updatePageStates:function(e){var t,n,i,s,o,u=this.state,a=u.pages,f=u.rows,l=this.$viewport.scrollTop(),c=this.$viewport.scrollLeft(),h=0,p=0,d=0,v=0;for(f.length=u.sumWidths=u.sumHeights=u.totalWidth=u.totalHeight=0,u.widestPage.totalActualWidth=u.tallestPage.totalActualHeight=0,t=0,n=this.$pages.length;n>t;++t)o=this.$pages.eq(t),s=o[0],i=a[t],(!i||e)&&(o.css("padding",""),i={index:t,paddingLeft:parseFloat(o.css(lt)),paddingRight:parseFloat(o.css(ft)),paddingTop:parseFloat(o.css(at)),paddingBottom:parseFloat(o.css(ct))}),i.actualWidth||(i.actualWidth=parseFloat(s.getAttribute("data-width"))),i.actualHeight||(i.actualHeight=parseFloat(s.getAttribute("data-height"))),i.totalActualWidth=i.actualWidth+i.paddingLeft+i.paddingRight,i.totalActualHeight=i.actualHeight+i.paddingTop+i.paddingBottom,i.width=s.offsetWidth,i.height=s.offsetHeight,i.x0=s.offsetLeft,i.y0=s.offsetTop,i.x1=i.width+i.x0,i.y1=i.height+i.y0,p&&r(a,f[h])<=i.y0+2&&h++,p=i.y1,f[h]||(f[h]=[]),i.totalActualWidth>u.widestPage.totalActualWidth&&(u.widestPage=i),i.totalActualHeight>u.tallestPage.totalActualHeight&&(u.tallestPage=i),u.sumWidths+=i.width,u.sumHeights+=i.height,i.rowIndex=h,a[t]=i,f[h].push(t),a[d].x0+a[d].width<i.x0+i.width&&(d=t),a[v].y0+a[v].height<i.y0+i.height&&(v=t);u.totalWidth=a[d].x0+a[d].width,u.totalHeight=a[v].y0+a[v].height,u.scrollTop=l,u.scrollLeft=c,this.setCurrentPage(this.calculateCurrentPage())},updateCurrentPage:function(){var e=this.calculateCurrentPage();this.setCurrentPage(e)},handleResize:function(e){var t=this.state.zoomState.zoomMode;this.state.viewportDimensions=e,this.updateZoomLevels(),this.setZoom(t)},handleScrollEnd:function(e){this.$doc.find("."+w).removeClass(w),this.$pages.eq(this.state.currentPage-1).addClass(w),this.updateVisiblePages(!0),this.handleScroll(e)},updateScrollPosition:function(e){var t,n,r=this.state,i=r.zoomState,s=i.zoom/i.prevZoom;t=r.scrollLeft*s,n=r.scrollTop*s,e!==!0&&(n+=r.viewportDimensions.offsetHeight*(s-1)/2,t+=r.viewportDimensions.offsetWidth*(s-1)/2),this.scrollToOffset(t,n)},updateLayout:function(){},calculateZoomAutoValue:function(){return 1},calculateNextPage:function(){return 1},calculatePreviousPage:function(){return 1}})}),At.addComponent("layout-"+et,["layout-"+Z],function(e,t){var n=e.getUtility("common");return t.extend({init:function(){this.twoPageMode=!0,t.init.call(this)},calculateNextPage:function(){return this.state.currentPage+2},calculatePreviousPage:function(){return this.state.currentPage-2},calculateZoomValue:function(e){var n=t.calculateZoomValue.call(this,e);return e===z&&(n/=2),n},scrollToPage:function(e){t.scrollToPage.call(this,e-(e+1)%2)},calculateVisibleRange:function(){var e=this.state.currentPage-1,t=e+1;return n.constrainRange(e,t,this.numPages)},calculateFullyVisibleRange:function(){return this.calculateVisibleRange()}})}),At.addComponent("layout-"+Z,["layout-paged"],function(e,t){var n=e.getUtility("common");return t.extend({init:function(){t.init.call(this),this.updatePageMargins(),this.updatePageClasses()},destroy:function(){t.destroy.call(this),this.$pages.css({margin:"",left:""}).removeClass(I)},calculateZoomAutoValue:function(){var e=this.calculateZoomValue(z),t=this.calculateZoomValue(W);return Math.min(e,t)},calculateCurrentPage:function(){return this.state.currentPage},calculateNextPage:function(){return this.state.currentPage+1},calculatePreviousPage:function(){return this.state.currentPage-1},calculateVisibleRange:function(){var e=this.state.currentPage-1;return n.constrainRange(e,e,this.numPages)},calculateFullyVisibleRange:function(){return this.calculateVisibleRange()},setCurrentPage:function(e){var r,i,s=n.clamp(e-1,0,this.numPages);t.setCurrentPage.call(this,e),this.$doc.find("."+E).removeClass(E),r=this.$doc.find("."+w),i=this.$pages.eq(s),r[0]!==i[0]&&(r.addClass(E).removeClass(w),i.addClass(w)),this.updateVisiblePages(!0),this.updatePageClasses(s)},scrollToPage:function(e){this.setCurrentPage(e)},updateLayout:function(){var e,t,n,r,i,s,o,u=this.state,a=u.zoomState,f=a.zoom,l=this.currentPage||1,c=u.pages[l-1],h=this.twoPageMode?u.pages[l]:c,p=u.viewportDimensions.clientWidth,d=u.viewportDimensions.clientHeight;e=h.actualWidth,t=c.actualWidth+(this.twoPageMode?e:0),n=c.actualHeight,r=Math.floor((t+c.paddingLeft+h.paddingRight)*f),i=Math.floor(c.totalActualHeight*f),s=Math.max(r,p),o=Math.max(i,d),this.$doc.css({width:s,height:o}),this.updatePageMargins(),s>p||o>d?this.$el.addClass("crocodoc-scrollable"):this.$el.removeClass("crocodoc-scrollable")},updatePageMargins:function(){var e,t,n,r,i,s,o,u,a,f=this.state,l=f.viewportDimensions.clientWidth,c=f.viewportDimensions.clientHeight;for(e=0,t=this.$pages.length;t>e;++e)r=this.$pages.eq(e),n=f.pages[e],a=this.twoPageMode?e%2===1?n.paddingRight:n.paddingLeft:n.paddingRight+n.paddingLeft,i=(n.actualWidth+a)*f.zoomState.zoom,s=(n.actualHeight+n.paddingTop+n.paddingBottom)*f.zoomState.zoom,this.twoPageMode?(o=Math.max(0,(l-2*i)/2),e%2===1&&(o+=i)):o=(l-i)/2,u=(c-s)/2,o=Math.max(o,0),u=Math.max(u,0),r.css({marginLeft:o,marginTop:u})},updatePageClasses:function(){var e=this.$pages,t=this.state.currentPage-1,n=t+1,r=t-1,i=20;e.removeClass(I),this.twoPageMode?(n=t+2,r=t-2,e.slice(Math.max(r,0),t).addClass(D),e.slice(n,n+2).addClass(P)):(r>=0&&e.eq(r).addClass(D),n<this.numPages&&e.eq(n).addClass(P)),e.slice(0,t).addClass(H),e.slice(Math.max(0,t-i),t).addClass(j),e.slice(n).addClass(B),e.slice(n,Math.min(this.numPages,n+i)).addClass(F)}})}),At.addComponent("layout-"+tt,["layout-base"],function(e,t){var n=e.getUtility("common");return t.extend({init:function(){t.init.call(this),this.zoomLevels=this.config.zoomLevels.slice(),this.minZoom=this.zoomLevels[0],this.maxZoom=this.zoomLevels[this.zoomLevels.length-1]},setZoom:function(t){var r,i=this.state.zoomState,s=i.zoom;"string"==typeof t?(r=this.calculateNextZoomLevel(t),r||(r="auto"===t||"fitwidth"===t||"fitheight"===t?1:s)):r=parseFloat(t)||s,r=n.clamp(r,this.minZoom,this.maxZoom),this.config.$doc.css("font-size",10*r+"pt"),i.prevZoom=s,i.zoom=r,i.canZoomIn=this.calculateNextZoomLevel(At.ZOOM_IN)!==!1,i.canZoomOut=this.calculateNextZoomLevel(At.ZOOM_OUT)!==!1,e.broadcast("zoom",n.extend({isDraggable:this.isDraggable()},i))}})}),At.addComponent("layout-"+G,["layout-"+Q],function(e,t){return t}),At.addComponent("layout-"+Q,["layout-paged"],function(e,t){var n=e.getUtility("common"),r=e.getUtility("browser");return t.extend({calculateZoomAutoValue:function(){var e=this.state,t=this.calculateZoomValue(z),n=this.calculateZoomValue(W);return e.widestPage.actualWidth>e.tallestPage.actualHeight?Math.min(1,t,n):r.mobile?t:Math.min(1,t)},calculateCurrentPage:function(){var e,t,r,i,s,o=this.state,u=o.pages;return e=n.bisectRight(u,o.scrollTop,"y0")-1,0>e?1:(s=o.scrollTop+u[e].height/2,t=n.bisectRight(u,s,"y0")-1,r=u[t].rowIndex,i=o.rows[r],1+i[0])},calculateNextPage:function(){var e=this.state,t=e.pages[e.currentPage-1],n=t.rowIndex,r=e.rows[n+1];return r&&r[0]+1||e.currentPage},calculatePreviousPage:function(){var e=this.state,t=e.pages[e.currentPage-1],n=t.rowIndex,r=e.rows[n-1];return r&&r[0]+1||e.currentPage},handleResize:function(e){t.handleResize.call(this,e),this.updateCurrentPage()},handleScroll:function(e){t.handleScroll.call(this,e),this.updateCurrentPage()},updateLayout:function(){var e,t,n=this.state,r=n.zoomState.zoom;e=Math.floor(n.widestPage.totalActualWidth*r),t=e<=n.viewportDimensions.clientWidth?"auto":e,this.$doc.css({width:t})}})}),At.addComponent("lazy-loader",function(e){function n(e){e=e||S;var t=C.page-1,n=t-e,r=t+e;return y.constrainRange(n,r,d-1)}function r(){var e;clearTimeout(g),E.length>0?(e=E.shift(),p[e]?w.loadPage(e,function(e){e===!1?r():g=setTimeout(r,dt)}):r()):s()}function i(){clearTimeout(g),x=!1,g=setTimeout(r,dt)}function s(){clearTimeout(g),x=!0}function o(e){E.push(e),x&&i()}function u(){E.length=0,s()}function a(e,t){var r=n(t);return e>=r.min&&e<=r.max?!0:!1}function f(e){var t=p[e];if(t){if(a(e))return!0;if(c(e))return!0}return!1}function l(e,t){return a(e,t)?!1:c(e)?!1:!0}function c(e){return y.inArray(e+1,C.visiblePages)>-1}function h(e,t){for(var n=y.sign(t-e);e!==t;)w.queuePageToLoad(e),e+=n;w.queuePageToLoad(e)}var p,d,v,m,g,y=e.getUtility("common"),b=e.getUtility("browser"),w={},E=[],S=1,x=!0,T=1,N=!1,C={page:1,visiblePages:[1]};return y.extend(w,{messages:["beforezoom","pageavailable","pagefocus","ready","scroll","scrollend","zoom"],onmessage:function(e,t){switch(e){case"beforezoom":this.handleBeforeZoom(t);break;case"pageavailable":this.handlePageAvailable(t);break;case"pagefocus":this.handlePageFocus(t);break;case"ready":this.handleReady();break;case"scroll":this.handleScroll();break;case"scrollend":this.handleScrollEnd();break;case"zoom":this.handleZoom(t)}},init:function(e){p=e,d=p.length,S=b.mobile||b.ielt10?mt:vt,S=Math.min(S,d)},destroy:function(){this.cancelAllLoading()},updateLayoutState:function(e){T=y.sign(e.page-C.page),C=e},loadNecessaryPages:y.debounce(100,function(){this.cancelAllLoading(),this.queuePageToLoad(C.page-1),this.loadVisiblePages(),this.loadPagesInRange(S)}),loadPagesInRange:function(e){var t=C.page-1;e>0&&(e=n(e),T>=0?(h(t+1,e.max),h(t-1,e.min)):(h(t-1,e.min),h(t+1,e.max)))},loadVisiblePages:function(){var e,t;for(e=0,t=C.visiblePages.length;t>e;++e)this.queuePageToLoad(C.visiblePages[e]-1)},queuePageToLoad:function(e){f(e)&&(p[e].preload(),o(e))},cancelAllLoading:function(){clearTimeout(m),clearTimeout(v),u()},loadPage:function(e,n){t.when(p[e]&&p[e].load()).always(n)},unloadPage:function(e){var t=p[e];t&&t.unload()},unloadUnnecessaryPages:function(e){var t,n;for(t=0,n=p.length;n>t;++t)l(t,e)&&this.unloadPage(t)},handleReady:function(){N=!0,this.loadVisiblePages(),m=setTimeout(function(){w.loadNecessaryPages()},gt)},handlePageAvailable:function(e){if(N){var t;if(e.all===!0&&(e.upto=d),e.page)this.queuePageToLoad(e.page-1);else if(e.upto)for(t=0;t<e.upto;++t)this.queuePageToLoad(t)}},handlePageFocus:function(e){this.updateLayoutState(e),N&&(this.cancelAllLoading(),v=setTimeout(function(){w.loadNecessaryPages()},200))},handleBeforeZoom:function(e){N&&(this.cancelAllLoading(),this.unloadUnnecessaryPages(2*e.visiblePages.length))},handleZoom:function(e){this.updateLayoutState(e),N&&this.loadNecessaryPages()},handleScroll:function(){this.cancelAllLoading()},handleScrollEnd:function(){N&&(this.loadNecessaryPages(),this.unloadUnnecessaryPages(S))}})}),At.addComponent("page-img",function(e){var n,r,i,s,o=e.getUtility("browser"),u=!1,a=o.mobile;return{init:function(e,n){r=t(e),s=n},destroy:function(){a=!0,this.unload(),r.empty()},prepare:function(){},preload:function(){i||(i=e.get("page-img",s))},load:function(){return this.preload(),i.done(function(e){u||(u=!0,n=t(e).appendTo(r))}),i.fail(function(t){u=!1,t&&e.broadcast("asseterror",t)}),i},unload:function(){i&&(i.abort(),i=null),a&&(n&&(n.remove(),n=null),u=!1)}}}),At.addComponent("page-links",function(e){function n(e){var n=t("<a>").addClass(k),o=e.bbox[0],u=e.bbox[1],a={};if(s.ie&&t("<span>").appendTo(n).on("click",r),n.css({left:o+"pt",top:u+"pt",width:e.bbox[2]-o+"pt",height:e.bbox[3]-u+"pt"}),e.uri){if(!/^http|^mailto/.test(e.uri))return;a.href=encodeURI(e.uri),a.target="_blank"}else e.destination&&(a.href="#page-"+e.destination.pagenum);n.attr(a),n.data("link",e),n.appendTo(i)}function r(n){var r=s.ie?n.target.parentNode:n.target,i=t(r),o=i.data("link");o&&e.broadcast("linkclick",o),n.preventDefault()}var i,s=e.getUtility("browser");return{init:function(e,n){i=t(e),this.createLinks(n),s.ie||i.on("click","."+k,r)},destroy:function(){i.empty().off("click"),i=s=null},createLinks:function(e){var t,r;for(t=0,r=e.length;r>t;++t)n(e[t])}}}),At.addComponent("page-svg",function(n){function r(){switch(S){case Et:case kt:return t("<iframe>");case Ct:case St:return t("<object>").attr({type:yt,data:"data:"+yt+";base64,"+e.btoa(wt)});case xt:return t("<div>");case Tt:return t("<object>");case Nt:case Lt:return t("<img>")}}function i(){c&&0!==c.length||(b=!1,c=r()),0===c.parent().length&&c.appendTo(h)}function s(){return b||S===Tt||S===Nt?t.Deferred().resolve().promise({abort:function(){}}):n.get("page-svg",d)}function o(e){var t=e.querySelectorAll("use");[].forEach.call(t,function(t){var n=t.getAttribute("xlink:href"),r=e.querySelector(n).cloneNode(),i=t.parentNode;r.removeAttribute("id"),r.setAttribute("transform",t.getAttribute("transform")),i.replaceChild(r,t)})}function u(t){var r,i,s,u,f,l=c[0].contentDocument,h=c[0].contentWindow||l&&l.defaultView;switch(S){case Et:v.ielt10&&(t=t.replace(/<xhtml:link.*/,"")),u=bt+t,v.ielt10?l.body.innerHTML=u:(l.documentElement.innerHTML=u,(v.ios||v.safari)&&v.version<7&&o(l)),s=l.getElementsByTagName("svg")[0];break;case kt:l.documentElement.innerHTML=bt;var p=l.getElementsByTagName("head")[0]||l.documentElement,g=l.createElement("script"),y="("+proxySVG+")()";g.type="text/javascript";try{g.appendChild(document.createTextNode(y))}catch(b){g.text=y}return p.insertBefore(g,p.firstChild),void ("complete"===l.readyState?h.loadSVG(t):h.onload=function(){this.loadSVG(t)});case St:r=new m,i=r.parseFromString(t,yt),s=l.importNode(i.documentElement,!0),l.documentElement.appendChild(s);break;case Ct:h.loadSVG(t),s=l.querySelector("svg");break;case xt:r=new m,i=r.parseFromString(t,yt),s=document.importNode(i.documentElement,!0),c.append(s);break;case Tt:c.attr({type:yt,data:n.getDataProvider("page-svg").getURL(d)}),s=c[0];break;case Nt:s=c[0],s.src=n.getDataProvider("page-svg").getURL(d);break;case Lt:s=c[0],f="data:"+yt,s.src=!v.ie&&e.btoa?f+";base64,"+e.btoa(t):f+","+encodeURIComponent(t)}s.setAttribute("width","100%"),s.setAttribute("height","100%")}function f(e){g||y||(!b&&e&&(u(e),b=!0,E||(p.abort(),p=null)),0===c.parent().length&&c.appendTo(h))}function l(e){n.broadcast("asseterror",e),b=!1,p&&p.abort()}var c,h,p,d,v=n.getUtility("browser"),m=e.DOMParser,g=!1,y=!1,b=!1,w=n.getConfig(),E=v.mobile||v.ielt10,S=v.ielt11||v.firefox?Lt:Et;return{init:function(e,t){h=e,d=t,S=w.embedStrategy||S},destroy:function(){g=!0,E=!0,this.unload(),h.empty()},prepare:function(){i()},preload:function(){this.prepare(),p||(p=s())},load:function(){return y=!1,this.preload(),p.done(f).fail(l),p},unload:function(){y=!0,p&&"resolved"!==p.state()&&(p.abort(),p=null),E&&(c&&(c.remove(),c=null),b=!1)}}}),At.addComponent("page-text",function(e){function n(){return p.enableTextSelection&&!f.ielt9}function r(e){var t,n;!e||h||c||(h=!0,t=document.implementation.createHTMLDocument(""),t.getElementsByTagName("body")[0].innerHTML=e,e=null,n=document.importNode(t.querySelector("."+C),!0),o.attr("class",n.getAttribute("class")),o.html(n.innerHTML),l.fix(o))}function i(t){t&&e.broadcast("asseterror",t)}function s(){return u||(u=n()?e.get("page-text",a):t.Deferred().resolve().promise({abort:function(){}})),u}var o,u,a,f=e.getUtility("browser"),l=e.getUtility("subpx"),c=!1,h=!1,p=e.getConfig();return{init:function(e,t){o=e,a=t},destroy:function(){c=!0,this.unload(),o.empty()},preload:function(){s()},load:function(){return s().done(r).fail(i)},unload:function(){u&&"resolved"!==u.state()&&(u.abort(),u=null)},enable:function(){o.css("display",""),u&&!h&&(u=null)},disable:function(){o.css("display","none")}}}),At.addComponent("page",function(e){var n,r,i,s,o,u,a,f,l=e.getUtility("support"),c=e.getUtility("common"),h=!1;return{messages:["pageavailable","pagefocus","textenabledchange","zoom"],onmessage:function(e,t){switch(e){case"pageavailable":(t.page===u+1||t.upto>u||t.all===!0)&&f===nt&&(f=rt);break;case"textenabledchange":t.enabled===!0?this.enableTextSelection():this.disableTextSelection();break;case"pagefocus":case"zoom":a=o===t.page||c.inArray(o,t.visiblePages)>-1}},init:function(t,a){var c,h,p;n=t,h=t.find("."+N),c=t.find("."+C),p=t.find("."+L),f=a.status||rt,u=a.index,o=u+1,this.config=a,a.url=a.url||"",r=e.createComponent("page-text"),i=e.createComponent(l.svg?"page-svg":"page-img"),r.init(c,o),i.init(h,o),a.enableLinks&&a.links.length&&(s=e.createComponent("page-links"),s.init(p,a.links))},destroy:function(){this.unload()},preload:function(){i.prepare(),f===rt&&(i.preload(),r.preload())},load:function(){var s=this;return h=!0,f===ot?!1:f===nt?!1:(f!==st&&(f=it),t.when(i.load(),r.load()).done(function(){h?f!==st&&(n.removeClass(O),f=st,e.broadcast("pageload",{page:o})):s.unload()}).fail(function(t){f=ot,n.addClass(M),e.broadcast("pagefail",{page:u+1,error:t})}))},unload:function(){h=!1,i.unload(),r.unload(),f===st&&(f=rt,n.addClass(O),n.removeClass(M),e.broadcast("pageunload",{page:o}))},enableTextSelection:function(){r.enable(),a&&r.load()},disableTextSelection:function(){r.disable()}}}),At.addComponent("resizer",function(n){function r(){n.broadcast("resize",{width:c,height:h,clientWidth:f,clientHeight:l,offsetWidth:c,offsetHeight:h})}function i(){var e=p.getComputedStyle(u);e&&"static"===e.position&&t(u).css({position:"relative"})}function s(){var e=t('<iframe frameborder="0">'),n=t("<div>");e.add(n).css({opacity:0,visiblility:"hidden",position:"absolute",width:"100%",height:"100%",top:0,left:0,border:0}),e.prependTo(n.prependTo(u)),i(),v=t(e[0].contentWindow),v.on("resize",o)}function o(){var t=u.offsetHeight,s=u.offsetWidth;return y&&0===g&&0!==e.innerWidth?(g=e.innerWidth,i(),void n.broadcast("layoutchange")):void (t&&(t!==h||s!==c)&&(h=t,c=s,l=u.clientHeight,f=u.clientWidth,r()))}var u,f,l,c,h,p=n.getUtility("common"),d=[""," webkit"," moz"," "].join("fullscreenchange")+"MSFullscreenChange",v=t(e),m=t(document),g=0,y=function(){try{return e.self!==e.top}catch(t){return!0}}();return{messages:["layoutchange"],onmessage:function(){h=null,o()},init:function(n){u=t(n).get(0),u===e?(u=document.documentElement,v.on("resize",o)):s(),m.on(d,o),o()},destroy:function(){m.off(d,o),v.off("resize",o)}}}),At.addComponent("scroller",function(e){function n(){return{scrollTop:f.scrollTop(),scrollLeft:f.scrollLeft()}}function r(){g=!1,S=null,clearTimeout(l),e.broadcast("scrollend",n())}function i(){g||(g=!0,e.broadcast("scrollstart",n())),clearTimeout(l),l=setTimeout(r,m),x()}function s(){y=!0,b=!1,w=!1,i()}function o(){w=!0,i()}function u(){y=!1,b=!0,E=(new Date).getTime(),w&&a()}function a(){return clearTimeout(l),null===S&&(S=(new Date).getTime()),(new Date).getTime()-S>p?void r():(x(),void (l=setTimeout(a,d)))}var f,l,c=e.getUtility("common"),h=e.getUtility("browser"),p=3e3,d=30,v=200,m=h.mobile?500:250,g=!1,y=!1,b=!1,w=!1,E=0,S=null,x=c.throttle(v,function(){e.broadcast("scroll",n())});return{init:function(e){f=t(e),f.on("scroll",i),f.on("touchstart",s),f.on("touchmove",o),f.on("touchend",u)},destroy:function(){clearTimeout(l),f.off("scroll",i),f.off("touchstart",s),f.off("touchmove",o),f.off("touchend",u)}}}),At.addComponent("viewer-base",function(n){function r(){x.attr(i,S.metadata.version||"0.0.0"),M.mobile&&x.addClass(v),M.ielt9&&x.addClass(m),_.svg&&x.addClass(g)}function f(){x.html(At.viewerTemplate),S.useWindowAsViewport?(S.$viewport=t(e),x.addClass(y)):S.$viewport=x.find("."+u),S.$doc=x.find("."+o)}function h(){var e,t,r=S.plugins||{};for(e in r)t=n.createComponent("plugin-"+e),t&&O.isFn(t.init)&&t.init(S.plugins[e])}function p(){r(),C=n.createComponent("scroller"),C.init(S.$viewport),k=n.createComponent("resizer"),k.init(S.$viewport);var e;switch(S.metadata.type){case"text":e=n.createComponent("controller-text"),S.layout=tt;break;case"paged":default:e=n.createComponent("controller-paged")}e.init(),"text"===S.metadata.type?S.enableTextSelection||E.disableTextSelection():M.ielt9&&E.disableTextSelection(),(!S.enableLinks||M.ielt9)&&E.disableLinks(),E.setLayout(S.layout),n.broadcast("ready",{page:S.page||1,numPages:S.numPages}),n.ready()}function d(t){var n=E.fire("linkclick",t);n.isDefaultPrevented()||(t.uri?e.open(t.uri):t.destination&&E.scrollTo(t.destination.pagenum))}function b(e){e?L||(x.addClass(l),L=n.createComponent("dragger"),L.init(S.$viewport)):L&&(x.removeClass(l),n.destroyComponent(L),L=null)}function w(){var e;S.queryParams&&(e="string"==typeof S.queryParams?S.queryParams.replace(/^\?/,""):O.param(S.queryParams)),S.queryString=e?"?"+e:""}var E,S,x,T,N,C,k,L,A,O=n.getUtility("common"),M=n.getUtility("browser"),_=n.getUtility("support");return{messages:["asseterror","destroy","dragend","dragstart","fail","layoutchange","linkclick","pagefail","pagefocus","pageload","pageunload","ready","resize","scrollstart","scrollend","zoom"],onmessage:function(e,t){switch(e){case"layoutchange":E.updateLayout();break;case"linkclick":d(t);break;case"zoom":t.zoom*=S.pageScale,t.prevZoom*=S.pageScale,S.enableDragging&&b(t.isDraggable),E.fire(e,t);break;case"dragstart":x.hasClass(c)||x.addClass(c),E.fire(e,t);break;case"dragend":x.hasClass(c)&&x.removeClass(c),E.fire(e,t);break;default:E.fire(e,t)}},init:function(){if(S=n.getConfig(),E=S.api,S.namespace=s+"-"+S.id,x=S.$el,x.addClass(s),x.addClass(S.namespace),!S.url)throw new Error("no URL given for viewer assets");/\/$/.test(S.url)||(S.url+="/"),S.url=n.getUtility("url").makeAbsolute(S.url),w(),f(),h()},destroy:function(){x.empty().removeClass(function(e,t){var n=t.match(new RegExp("crocodoc\\S+","g"));return n&&n.join(" ")}),t(T).remove(),A&&A.abort()},setLayout:function(e){var t,r=S.page,i=S.zoom||1,s=S.layout;if(N){if(e===s)return N;r=N.state.currentPage,i=N.state.zoomState}if(t=n.createComponent("layout-"+e),!t)throw new Error("Invalid layout "+e);return N&&n.destroyComponent(N),S.layout=e,N=t,N.init(),N.setZoom(i.zoomMode||i.zoom||i),O.isFn(N.scrollTo)&&N.scrollTo(r),S.currentLayout=N,n.broadcast("layoutchange",{previousLayout:s,layout:e}),N},loadAssets:function(){var e,r,i,s;A||(r=n.get("metadata"),r.then(function(e){S.metadata=e}),M.ielt9?(T=O.insertCSS(""),S.stylesheet=T.styleSheet,e=t.when("").promise({abort:function(){}})):(e=n.get("stylesheet"),e.then(function(e){T=O.insertCSS(e),S.stylesheet=T.sheet})),!S.autoloadFirstPage||S.pageStart&&1!==S.pageStart||(_.svg?i=n.get("page-svg",1):S.conversionIsComplete&&(i=n.get("page-img",1)),S.enableTextSelection&&(s=n.get("page-text",1))),A=t.when(r,e).fail(function(e){A&&A.abort(),n.ready(),n.broadcast("asseterror",e),n.broadcast("fail",e)}).then(p).promise({abort:function(){A=null,r.abort(),e.abort(),i&&i.abort(),s&&s.abort()}}))}}}),At})}("undefined"!=typeof window?window:this),define("crocodoc.viewer.min",function(){}),define("player",["require","jquery","jade","log","framework","./crocodoc.viewer.min","./pointer"],function(e){function h(e){if(!f[e])return;var t=f[e].viewer_handle;return t?t:(n.error('no viewer found for "'+e+'"'),null)}function p(){t("#widget-tabs").on("click",".content-player-outer .content-menu ul li.content-page-nav",function(e){d(e)}),t("#widget-tabs").on("click",".content-player-outer .content-menu ul li.content-layout-toggle",function(e){b(e)}),t("#widget-tabs").on("click",".content-player-outer .content-preview-menu ul li.content-share",function(e){S(e)}),t("#widget-tabs").on("click",".content-player-outer .content-preview-menu ul li.content-preview-close",function(e){w(e)}),t("#widget-tabs").on("click",".content-player-outer .content-menu ul li.content-library",function(e){E(e)})}function d(e){var n=t(e.currentTarget),r=n.closest(".content-player-outer").attr("data-uuid"),i=h(r);if(!i)return;var s=n.attr("data-nav-direction");s=s==="next"?Crocodoc.SCROLL_NEXT:Crocodoc.SCROLL_PREVIOUS,i.scrollTo(s)}function v(e,t){var n=e.find(".content-player-outer"),r=t.data.page;if(a("write","control")){var i=e.attr("data-tab-uuid"),s={uuid:i,page:r};u.send_info("*","navigate-to",s,0)}}function m(e,t,n){var r=this;if(a("write","control")&&!c){var i=r.attr("data-tab-uuid"),s={uuid:i,scroll_to:n.data,zoom:t.getZoom()};u.send_info("*","scroll-to",s,0)}c=!1}function b(e){var n=t(e.currentTarget),r=n.closest(".content-player-outer").attr("data-uuid"),i=h(r);if(!i)return;y=(y+1)%g.length,i.setLayout(g[y].layout),t(e.currentTarget).find("span.tooltip-text").html(g[y].tooltip)}function w(e){if(!a("write","control"))return;var n=t(e.currentTarget),r=n.closest(".content-player-outer").attr("data-uuid"),i=n.closest(".tab-pane"),s=t("ul.nav.nav-tabs li[data-tab-uuid="+r+"]");x(r,i,!0),s&&s.hasClass("tab-is-shared")&&(s.removeClass("tab-is-shared"),u.tabs.destroyed({uuid:r,preview_close:!0}),u.send_info("*","content-destroyed",{uuid:r},0))}function E(e){if(!a("write","control"))return;var n=t(e.currentTarget),r=n.closest(".tab-pane");N(r,"fullview-with-library")}function S(e){if(!a("write","control"))return;var n=t(e.currentTarget),r=n.closest(".tab-pane"),i=n.closest(".content-player-outer").attr("data-uuid"),o=n.closest(".content-player-outer"),l=h(i),c={uuid:i,owner:u.identity.vc_id,doc_info:f[i].doc_info};s.register(l,i,!1),u.send_info("*","new-content",c,0),u.tabs.sync_remote({uuid:i}),N(r,"fullview")}function x(e,t,r){var i=h(e);if(!i)return;try{i.destroy()}catch(s){n.info("crocodoc destroy viewer exception ",s)}t.find(".content-player-outer").empty(),t.find(".content-player-outer").remove(),delete f[e],r&&N(t,null)}function N(e,t){t&&e.addClass("content-"+t);for(var n in T)n!=t&&e.removeClass("content-"+n)}function C(e,t,r,i){try{n.info("scroll info",t);switch(t.type){case"page":o.navigate(r,i,t.data);break;case"scroll_to":o.scroll_to(r,i,t.data)}}catch(s){n.info("unable to scroll ["+url+"]: reason : ",s)}}var t=e("jquery");window.jade=e("jade");var n=e("log")("content-player","info"),r=e("framework"),i=e("./crocodoc.viewer.min"),s=e("./pointer"),o={},u,a,f={},l="https://boxcontent.s3.amazonaws.com/9a99bc2a1dde42698e1e6bab105193ab";o.init=function(e,t,r,i){return u=i,a=i.perms.has_perm,p(),Crocodoc.addPlugin("resizeChromeFix",function(e){var t=e.getConfig(),n;return{init:function(n){var r=e.getConfig().api;r.resizeForChrome=function(){var e=t.currentLayout;e.handleResize({clientWidth:e.$viewport[0].clientWidth,clientHeight:e.$viewport[0].clientHeight,offsetWidth:e.$viewport[0].offsetWidth,offsetHeight:e.$viewport[0].offsetHeight});return}}}}),Crocodoc.addPlugin("scrolltooffset",function(e){var t=e.getConfig(),r;return{init:function(r){var i=e.getConfig().api;i.getZoom=function(){var e=t.currentLayout,n=e.state.zoomState.zoom;return n},i.getGeometry=function(){var e=t.currentLayout;if(!e.calculateCurrentPage)return{page_width:e.$viewport.find("table.crocodoc-text").width(),viewport_width:e.$viewport.find("table.crocodoc-text").width()};var n=e.calculateCurrentPage();return{page_width:e.state.pages[n-1].width,viewport_width:e.state.viewportDimensions.clientWidth}},i.scrollToOffset=function(e,r,i){var s=t.currentLayout,o=s.state.zoomState.zoom;n.info("scrollToOffset: ",e,r,i,o),s.scrollToOffset(e*o/i,r*o/i)}}}}),!0},o.start=function(e,r,i){var s=t(e.anchor),a,l=s.attr("id"),c=t.Deferred();N(s,"loading"),o.destroy(s),s.find(".content-player-outer").remove(),i.shared="no";var h=u.template("player");s.append(h({uuid:e.uuid,content_uri:r.url,shared:i.shared})),u.tabs.set_title({uuid:e.uuid,title:r.name});var p=s.find(".content-area");return a=Crocodoc.createViewer(p,{url:r.url,enableDragging:!1,plugins:{resizeChromeFix:{},scrolltooffset:{}}}),a.load(),f[e.uuid]={viewer_handle:a,doc_info:r,active:u.tabs.is_active(e.uuid)},a.on("asseterror",function(e){n.error("content asseterror  = ",e),c.reject(e)}),a.on("fail",function(e){n.error("content failed to load  = ",e),c.reject(e)}),a.on("ready",function(t){n.info("viewer ready : data = ",t.data);try{a.setLayout(Crocodoc.LAYOUT_VERTICAL_SINGLE_COLUMN)}catch(r){}var f=i.mode?i.mode:"fullview";N(s,f),a.resizeForChrome(),i.scroll_info&&C(a,i.scroll_info,e.uuid,s);var l=u.perms.has_perm("write","control");o.set_enabled(l,e.uuid),current_page=t.data.page;var h={current_page:current_page,total_pages:t.data.numPages,viewer:a};c.resolve(h)}),a.on("resize",function(e){n.info("resize ",e)}),a.on("pagefocus",function(e){v(s,e)}),a.on("scrollstart",function(e){n.info("scrollstart : left = "+e.data.scrollLeft+", top = "+e.data.scrollTop)}),a.on("scrollend",function(e){n.info("scrollend : left = "+e.data.scrollLeft+", top = "+e.data.scrollTop),m.call(s,s.find(".content-player-outer"),a,e)}),c.promise()},o.now_showing=function(e){var t=e.uuid;if(!t)return n.error("now_showing : no uuid in options",e);if(!f[t])return;n.info("now_showing : ",e,f);var r=f[t];r.pending_navigation&&(n.info("finishing pending navigation for "+t,r.pending_navigation),r.viewer_handle.scrollTo(r.pending_navigation.page),delete r.pending_navigation),r.pending_scroll_to&&(n.info("finishing pending scroll_to for "+t,r.pending_scroll_to),r.viewer_handle.scrollToOffset(r.pending_scroll_to.scroll_to.scrollLeft,r.pending_scroll_to.scroll_to.scrollTop,r.pending_scroll_to.zoom),delete r.pending_scroll_to)},o.now_hidden=function(e){n.info("now_hidden : ",e,f)},o.destroy=function(e,n,r){var i=e.find(".content-player-outer");if(i.length===0)return;x(n,e,!1);if(r)return;var s=u.tabs.get_by_uuid(n)||{},o=u.identity,a=t("li[data-tab-uuid="+n+"]").hasClass("tab-is-shared");if(s.owner===o.id&&!a)return;u.send_info("*","content-destroyed",{uuid:n},0)},o.navigate=function(e,t,r){var i=h(e);if(u.tabs.is_active(e)){n.info("navigate to : "+r.page,r),i.scrollTo(r.page);return}n.info("pennding navigation for "+e),f[e].pending_navigation=r};var c=!1;o.scroll_to=function(e,t,r){c=!0;var i=h(e);u.tabs.is_active(e)&&(n.info("scroll to : left = "+r.scroll_to.scrollLeft+", top = "+r.scroll_to.scrollTop),i.scrollToOffset(r.scroll_to.scrollLeft,r.scroll_to.scrollTop,r.zoom)),n.info("pennding scroll_to for "+e),f[e].pending_scroll_to=r},o.set_enabled=function(e,n,r){if(!n)return;var i=u.tabs.get_by_uuid(n)||{},s=i.handle,o=s&&s.anchor,a=t(o);!e,a.find(".crocodoc-viewport").css("overflow",e?"scroll":"hidden"),a.find(".content-menu").css("display",e?"":"none"),i.owner!==u.identity.vc_id&&a.find("li.content-library").css("display","none")};var g=[{layout:Crocodoc.LAYOUT_VERTICAL_SINGLE_COLUMN,tooltip:"Vertical, Single Column, Scrollable"},{layout:Crocodoc.LAYOUT_HORIZONTAL,tooltip:"Horizontal, Single Row, Scrollable"},{layout:Crocodoc.LAYOUT_PRESENTATION,tooltip:"Presentation, One page at a time"},{layout:Crocodoc.LAYOUT_PRESENTATION_TWO_PAGE,tooltip:"Presentation, Two pages at a time"}],y=0,T={loading:!0,preview:!0,fullview:!0,"fullview-with-library":!0};return o}),!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("moment",t):e.moment=t()}(this,function(){"use strict";function e(){return Pr.apply(null,arguments)}function t(e){Pr=e}function n(e){return"[object Array]"===Object.prototype.toString.call(e)}function r(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function i(e,t){var n,r=[];for(n=0;n<e.length;++n)r.push(t(e[n],n));return r}function s(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function o(e,t){for(var n in t)s(t,n)&&(e[n]=t[n]);return s(t,"toString")&&(e.toString=t.toString),s(t,"valueOf")&&(e.valueOf=t.valueOf),e}function u(e,t,n,r){return Lt(e,t,n,r,!0).utc()}function a(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function f(e){return null==e._pf&&(e._pf=a()),e._pf}function l(e){if(null==e._isValid){var t=f(e);e._isValid=!(isNaN(e._d.getTime())||!(t.overflow<0)||t.empty||t.invalidMonth||t.invalidWeekday||t.nullInput||t.invalidFormat||t.userInvalidated),e._strict&&(e._isValid=e._isValid&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour)}return e._isValid}function c(e){var t=u(NaN);return null!=e?o(f(t),e):f(t).userInvalidated=!0,t}function h(e,t){var n,r,i;if("undefined"!=typeof t._isAMomentObject&&(e._isAMomentObject=t._isAMomentObject),"undefined"!=typeof t._i&&(e._i=t._i),"undefined"!=typeof t._f&&(e._f=t._f),"undefined"!=typeof t._l&&(e._l=t._l),"undefined"!=typeof t._strict&&(e._strict=t._strict),"undefined"!=typeof t._tzm&&(e._tzm=t._tzm),"undefined"!=typeof t._isUTC&&(e._isUTC=t._isUTC),"undefined"!=typeof t._offset&&(e._offset=t._offset),"undefined"!=typeof t._pf&&(e._pf=f(t)),"undefined"!=typeof t._locale&&(e._locale=t._locale),Br.length>0)for(n in Br)r=Br[n],i=t[r],"undefined"!=typeof i&&(e[r]=i);return e}function p(t){h(this,t),this._d=new Date(null!=t._d?t._d.getTime():NaN),jr===!1&&(jr=!0,e.updateOffset(this),jr=!1)}function d(e){return e instanceof p||null!=e&&null!=e._isAMomentObject}function v(e){return 0>e?Math.ceil(e):Math.floor(e)}function m(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=v(t)),n}function g(e,t,n){var r,i=Math.min(e.length,t.length),s=Math.abs(e.length-t.length),o=0;for(r=0;i>r;r++)(n&&e[r]!==t[r]||!n&&m(e[r])!==m(t[r]))&&o++;return o+s}function y(){}function b(e){return e?e.toLowerCase().replace("_","-"):e}function w(e){for(var t,n,r,i,s=0;s<e.length;){for(i=b(e[s]).split("-"),t=i.length,n=b(e[s+1]),n=n?n.split("-"):null;t>0;){if(r=E(i.slice(0,t).join("-")))return r;if(n&&n.length>=t&&g(i,n,!0)>=t-1)break;t--}s++}return null}function E(e){var t=null;if(!Fr[e]&&"undefined"!=typeof module&&module&&module.exports)try{t=Hr._abbr,require("./locale/"+e),S(t)}catch(n){}return Fr[e]}function S(e,t){var n;return e&&(n="undefined"==typeof t?T(e):x(e,t),n&&(Hr=n)),Hr._abbr}function x(e,t){return null!==t?(t.abbr=e,Fr[e]=Fr[e]||new y,Fr[e].set(t),S(e),Fr[e]):(delete Fr[e],null)}function T(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Hr;if(!n(e)){if(t=E(e))return t;e=[e]}return w(e)}function N(e,t){var n=e.toLowerCase();Ir[n]=Ir[n+"s"]=Ir[t]=e}function C(e){return"string"==typeof e?Ir[e]||Ir[e.toLowerCase()]:void 0}function k(e){var t,n,r={};for(n in e)s(e,n)&&(t=C(n),t&&(r[t]=e[n]));return r}function L(t,n){return function(r){return null!=r?(O(this,t,r),e.updateOffset(this,n),this):A(this,t)}}function A(e,t){return e._d["get"+(e._isUTC?"UTC":"")+t]()}function O(e,t,n){return e._d["set"+(e._isUTC?"UTC":"")+t](n)}function M(e,t){var n;if("object"==typeof e)for(n in e)this.set(n,e[n]);else if(e=C(e),"function"==typeof this[e])return this[e](t);return this}function _(e,t,n){var r=""+Math.abs(e),i=t-r.length,s=e>=0;return(s?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}function D(e,t,n,r){var i=r;"string"==typeof r&&(i=function(){return this[r]()}),e&&(zr[e]=i),t&&(zr[t[0]]=function(){return _(i.apply(this,arguments),t[1],t[2])}),n&&(zr[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function P(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function H(e){var t,n,r=e.match(qr);for(t=0,n=r.length;n>t;t++)zr[r[t]]?r[t]=zr[r[t]]:r[t]=P(r[t]);return function(i){var s="";for(t=0;n>t;t++)s+=r[t]instanceof Function?r[t].call(i,e):r[t];return s}}function B(e,t){return e.isValid()?(t=j(t,e.localeData()),Ur[t]=Ur[t]||H(t),Ur[t](e)):e.localeData().invalidDate()}function j(e,t){function n(e){return t.longDateFormat(e)||e}var r=5;for(Rr.lastIndex=0;r>=0&&Rr.test(e);)e=e.replace(Rr,n),Rr.lastIndex=0,r-=1;return e}function F(e){return"function"==typeof e&&"[object Function]"===Object.prototype.toString.call(e)}function I(e,t,n){ii[e]=F(t)?t:function(e){return e&&n?n:t}}function q(e,t){return s(ii,e)?ii[e](t._strict,t._locale):new RegExp(R(e))}function R(e){return e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,r,i){return t||n||r||i}).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function U(e,t){var n,r=t;for("string"==typeof e&&(e=[e]),"number"==typeof t&&(r=function(e,n){n[t]=m(e)}),n=0;n<e.length;n++)si[e[n]]=r}function z(e,t){U(e,function(e,n,r,i){r._w=r._w||{},t(e,r._w,r,i)})}function W(e,t,n){null!=t&&s(si,e)&&si[e](t,n._a,n,e)}function X(e,t){return(new Date(Date.UTC(e,t+1,0))).getUTCDate()}function V(e){return this._months[e.month()]}function $(e){return this._monthsShort[e.month()]}function J(e,t,n){var r,i,s;for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;12>r;r++){if(i=u([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),n||this._monthsParse[r]||(s="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(s.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[r].test(e))return r;if(n&&"MMM"===t&&this._shortMonthsParse[r].test(e))return r;if(!n&&this._monthsParse[r].test(e))return r}}function K(e,t){var n;return"string"==typeof t&&(t=e.localeData().monthsParse(t),"number"!=typeof t)?e:(n=Math.min(e.date(),X(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e)}function Q(t){return null!=t?(K(this,t),e.updateOffset(this,!0),this):A(this,"Month")}function G(){return X(this.year(),this.month())}function Y(e){var t,n=e._a;return n&&-2===f(e).overflow&&(t=n[ui]<0||n[ui]>11?ui:n[ai]<1||n[ai]>X(n[oi],n[ui])?ai:n[fi]<0||n[fi]>24||24===n[fi]&&(0!==n[li]||0!==n[ci]||0!==n[hi])?fi:n[li]<0||n[li]>59?li:n[ci]<0||n[ci]>59?ci:n[hi]<0||n[hi]>999?hi:-1,f(e)._overflowDayOfYear&&(oi>t||t>ai)&&(t=ai),f(e).overflow=t),e}function Z(t){e.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+t)}function et(e,t){var n=!0;return o(function(){return n&&(Z(e+"\n"+(new Error).stack),n=!1),t.apply(this,arguments)},t)}function tt(e,t){vi[e]||(Z(t),vi[e]=!0)}function nt(e){var t,n,r=e._i,i=mi.exec(r);if(i){for(f(e).iso=!0,t=0,n=gi.length;n>t;t++)if(gi[t][1].exec(r)){e._f=gi[t][0];break}for(t=0,n=yi.length;n>t;t++)if(yi[t][1].exec(r)){e._f+=(i[6]||" ")+yi[t][0];break}r.match(ti)&&(e._f+="Z"),Et(e)}else e._isValid=!1}function rt(t){var n=bi.exec(t._i);return null!==n?void (t._d=new Date(+n[1])):(nt(t),void (t._isValid===!1&&(delete t._isValid,e.createFromInputFallback(t))))}function it(e,t,n,r,i,s,o){var u=new Date(e,t,n,r,i,s,o);return 1970>e&&u.setFullYear(e),u}function st(e){var t=new Date(Date.UTC.apply(null,arguments));return 1970>e&&t.setUTCFullYear(e),t}function ot(e){return ut(e)?366:365}function ut(e){return e%4===0&&e%100!==0||e%400===0}function at(){return ut(this.year())}function ft(e,t,n){var r,i=n-t,s=n-e.day();return s>i&&(s-=7),i-7>s&&(s+=7),r=At(e).add(s,"d"),{week:Math.ceil(r.dayOfYear()/7),year:r.year()}}function lt(e){return ft(e,this._week.dow,this._week.doy).week}function ct(){return this._week.dow}function ht(){return this._week.doy}function pt(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function dt(e){var t=ft(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function vt(e,t,n,r,i){var s,o=6+i-r,u=st(e,0,1+o),a=u.getUTCDay();return i>a&&(a+=7),n=null!=n?1*n:i,s=1+o+7*(t-1)-a+n,{year:s>0?e:e-1,dayOfYear:s>0?s:ot(e-1)+s}}function mt(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}function gt(e,t,n){return null!=e?e:null!=t?t:n}function yt(e){var t=new Date;return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function bt(e){var t,n,r,i,s=[];if(!e._d){for(r=yt(e),e._w&&null==e._a[ai]&&null==e._a[ui]&&wt(e),e._dayOfYear&&(i=gt(e._a[oi],r[oi]),e._dayOfYear>ot(i)&&(f(e)._overflowDayOfYear=!0),n=st(i,0,e._dayOfYear),e._a[ui]=n.getUTCMonth(),e._a[ai]=n.getUTCDate()),t=0;3>t&&null==e._a[t];++t)e._a[t]=s[t]=r[t];for(;7>t;t++)e._a[t]=s[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[fi]&&0===e._a[li]&&0===e._a[ci]&&0===e._a[hi]&&(e._nextDay=!0,e._a[fi]=0),e._d=(e._useUTC?st:it).apply(null,s),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[fi]=24)}}function wt(e){var t,n,r,i,s,o,u;t=e._w,null!=t.GG||null!=t.W||null!=t.E?(s=1,o=4,n=gt(t.GG,e._a[oi],ft(At(),1,4).year),r=gt(t.W,1),i=gt(t.E,1)):(s=e._locale._week.dow,o=e._locale._week.doy,n=gt(t.gg,e._a[oi],ft(At(),s,o).year),r=gt(t.w,1),null!=t.d?(i=t.d,s>i&&++r):i=null!=t.e?t.e+s:s),u=vt(n,r,i,o,s),e._a[oi]=u.year,e._dayOfYear=u.dayOfYear}function Et(t){if(t._f===e.ISO_8601)return void nt(t);t._a=[],f(t).empty=!0;var n,r,i,s,o,u=""+t._i,a=u.length,l=0;for(i=j(t._f,t._locale).match(qr)||[],n=0;n<i.length;n++)s=i[n],r=(u.match(q(s,t))||[])[0],r&&(o=u.substr(0,u.indexOf(r)),o.length>0&&f(t).unusedInput.push(o),u=u.slice(u.indexOf(r)+r.length),l+=r.length),zr[s]?(r?f(t).empty=!1:f(t).unusedTokens.push(s),W(s,r,t)):t._strict&&!r&&f(t).unusedTokens.push(s);f(t).charsLeftOver=a-l,u.length>0&&f(t).unusedInput.push(u),f(t).bigHour===!0&&t._a[fi]<=12&&t._a[fi]>0&&(f(t).bigHour=void 0),t._a[fi]=St(t._locale,t._a[fi],t._meridiem),bt(t),Y(t)}function St(e,t,n){var r;return null==n?t:null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?(r=e.isPM(n),r&&12>t&&(t+=12),r||12!==t||(t=0),t):t}function xt(e){var t,n,r,i,s;if(0===e._f.length)return f(e).invalidFormat=!0,void (e._d=new Date(NaN));for(i=0;i<e._f.length;i++)s=0,t=h({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[i],Et(t),l(t)&&(s+=f(t).charsLeftOver,s+=10*f(t).unusedTokens.length,f(t).score=s,(null==r||r>s)&&(r=s,n=t));o(e,n||t)}function Tt(e){if(!e._d){var t=k(e._i);e._a=[t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],bt(e)}}function Nt(e){var t=new p(Y(Ct(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function Ct(e){var t=e._i,i=e._f;return e._locale=e._locale||T(e._l),null===t||void 0===i&&""===t?c({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),d(t)?new p(Y(t)):(n(i)?xt(e):i?Et(e):r(t)?e._d=t:kt(e),e))}function kt(t){var s=t._i;void 0===s?t._d=new Date:r(s)?t._d=new Date(+s):"string"==typeof s?rt(t):n(s)?(t._a=i(s.slice(0),function(e){return parseInt(e,10)}),bt(t)):"object"==typeof s?Tt(t):"number"==typeof s?t._d=new Date(s):e.createFromInputFallback(t)}function Lt(e,t,n,r,i){var s={};return"boolean"==typeof n&&(r=n,n=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=i,s._l=n,s._i=e,s._f=t,s._strict=r,Nt(s)}function At(e,t,n,r){return Lt(e,t,n,r,!1)}function Ot(e,t){var r,i;if(1===t.length&&n(t[0])&&(t=t[0]),!t.length)return At();for(r=t[0],i=1;i<t.length;++i)(!t[i].isValid()||t[i][e](r))&&(r=t[i]);return r}function Mt(){var e=[].slice.call(arguments,0);return Ot("isBefore",e)}function _t(){var e=[].slice.call(arguments,0);return Ot("isAfter",e)}function Dt(e){var t=k(e),n=t.year||0,r=t.quarter||0,i=t.month||0,s=t.week||0,o=t.day||0,u=t.hour||0,a=t.minute||0,f=t.second||0,l=t.millisecond||0;this._milliseconds=+l+1e3*f+6e4*a+36e5*u,this._days=+o+7*s,this._months=+i+3*r+12*n,this._data={},this._locale=T(),this._bubble()}function Pt(e){return e instanceof Dt}function Ht(e,t){D(e,0,0,function(){var e=this.utcOffset(),n="+";return 0>e&&(e=-e,n="-"),n+_(~~(e/60),2)+t+_(~~e%60,2)})}function Bt(e){var t=(e||"").match(ti)||[],n=t[t.length-1]||[],r=(n+"").match(Ti)||["-",0,0],i=+(60*r[1])+m(r[2]);return"+"===r[0]?i:-i}function jt(t,n){var i,s;return n._isUTC?(i=n.clone(),s=(d(t)||r(t)?+t:+At(t))- +i,i._d.setTime(+i._d+s),e.updateOffset(i,!1),i):At(t).local()}function Ft(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function It(t,n){var r,i=this._offset||0;return null!=t?("string"==typeof t&&(t=Bt(t)),Math.abs(t)<16&&(t=60*t),!this._isUTC&&n&&(r=Ft(this)),this._offset=t,this._isUTC=!0,null!=r&&this.add(r,"m"),i!==t&&(!n||this._changeInProgress?tn(this,Qt(t-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,e.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?i:Ft(this)}function qt(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function Rt(e){return this.utcOffset(0,e)}function Ut(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Ft(this),"m")),this}function zt(){return this._tzm?this.utcOffset(this._tzm):"string"==typeof this._i&&this.utcOffset(Bt(this._i)),this}function Wt(e){return e=e?At(e).utcOffset():0,(this.utcOffset()-e)%60===0}function Xt(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Vt(){if("undefined"!=typeof this._isDSTShifted)return this._isDSTShifted;var e={};if(h(e,this),e=Ct(e),e._a){var t=e._isUTC?u(e._a):At(e._a);this._isDSTShifted=this.isValid()&&g(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function $t(){return!this._isUTC}function Jt(){return this._isUTC}function Kt(){return this._isUTC&&0===this._offset}function Qt(e,t){var n,r,i,o=e,u=null;return Pt(e)?o={ms:e._milliseconds,d:e._days,M:e._months}:"number"==typeof e?(o={},t?o[t]=e:o.milliseconds=e):(u=Ni.exec(e))?(n="-"===u[1]?-1:1,o={y:0,d:m(u[ai])*n,h:m(u[fi])*n,m:m(u[li])*n,s:m(u[ci])*n,ms:m(u[hi])*n}):(u=Ci.exec(e))?(n="-"===u[1]?-1:1,o={y:Gt(u[2],n),M:Gt(u[3],n),d:Gt(u[4],n),h:Gt(u[5],n),m:Gt(u[6],n),s:Gt(u[7],n),w:Gt(u[8],n)}):null==o?o={}:"object"==typeof o&&("from"in o||"to"in o)&&(i=Zt(At(o.from),At(o.to)),o={},o.ms=i.milliseconds,o.M=i.months),r=new Dt(o),Pt(e)&&s(e,"_locale")&&(r._locale=e._locale),r}function Gt(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function Yt(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t- +e.clone().add(n.months,"M"),n}function Zt(e,t){var n;return t=jt(t,e),e.isBefore(t)?n=Yt(e,t):(n=Yt(t,e),n.milliseconds=-n.milliseconds,n.months=-n.months),n}function en(e,t){return function(n,r){var i,s;return null===r||isNaN(+r)||(tt(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period)."),s=n,n=r,r=s),n="string"==typeof n?+n:n,i=Qt(n,r),tn(this,i,e),this}}function tn(t,n,r,i){var s=n._milliseconds,o=n._days,u=n._months;i=null==i?!0:i,s&&t._d.setTime(+t._d+s*r),o&&O(t,"Date",A(t,"Date")+o*r),u&&K(t,A(t,"Month")+u*r),i&&e.updateOffset(t,o||u)}function nn(e,t){var n=e||At(),r=jt(n,this).startOf("day"),i=this.diff(r,"days",!0),s=-6>i?"sameElse":-1>i?"lastWeek":0>i?"lastDay":1>i?"sameDay":2>i?"nextDay":7>i?"nextWeek":"sameElse";return this.format(t&&t[s]||this.localeData().calendar(s,this,At(n)))}function rn(){return new p(this)}function sn(e,t){var n;return t=C("undefined"!=typeof t?t:"millisecond"),"millisecond"===t?(e=d(e)?e:At(e),+this>+e):(n=d(e)?+e:+At(e),n<+this.clone().startOf(t))}function on(e,t){var n;return t=C("undefined"!=typeof t?t:"millisecond"),"millisecond"===t?(e=d(e)?e:At(e),+e>+this):(n=d(e)?+e:+At(e),+this.clone().endOf(t)<n)}function un(e,t,n){return this.isAfter(e,n)&&this.isBefore(t,n)}function an(e,t){var n;return t=C(t||"millisecond"),"millisecond"===t?(e=d(e)?e:At(e),+this===+e):(n=+At(e),+this.clone().startOf(t)<=n&&n<=+this.clone().endOf(t))}function fn(e,t,n){var r,i,s=jt(e,this),o=6e4*(s.utcOffset()-this.utcOffset());return t=C(t),"year"===t||"month"===t||"quarter"===t?(i=ln(this,s),"quarter"===t?i/=3:"year"===t&&(i/=12)):(r=this-s,i="second"===t?r/1e3:"minute"===t?r/6e4:"hour"===t?r/36e5:"day"===t?(r-o)/864e5:"week"===t?(r-o)/6048e5:r),n?i:v(i)}function ln(e,t){var n,r,i=12*(t.year()-e.year())+(t.month()-e.month()),s=e.clone().add(i,"months");return 0>t-s?(n=e.clone().add(i-1,"months"),r=(t-s)/(s-n)):(n=e.clone().add(i+1,"months"),r=(t-s)/(n-s)),-(i+r)}function cn(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function hn(){var e=this.clone().utc();return 0<e.year()&&e.year()<=9999?"function"==typeof Date.prototype.toISOString?this.toDate().toISOString():B(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):B(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function pn(t){var n=B(this,t||e.defaultFormat);return this.localeData().postformat(n)}function dn(e,t){return this.isValid()?Qt({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function vn(e){return this.from(At(),e)}function mn(e,t){return this.isValid()?Qt({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function gn(e){return this.to(At(),e)}function yn(e){var t;return void 0===e?this._locale._abbr:(t=T(e),null!=t&&(this._locale=t),this)}function bn(){return this._locale}function wn(e){switch(e=C(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this}function En(e){return e=C(e),void 0===e||"millisecond"===e?this:this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms")}function Sn(){return+this._d-6e4*(this._offset||0)}function xn(){return Math.floor(+this/1e3)}function Tn(){return this._offset?new Date(+this):this._d}function Nn(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Cn(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function kn(){return l(this)}function Ln(){return o({},f(this))}function An(){return f(this).overflow}function On(e,t){D(0,[e,e.length],0,t)}function Mn(e,t,n){return ft(At([e,11,31+t-n]),t,n).week}function _n(e){var t=ft(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==e?t:this.add(e-t,"y")}function Dn(e){var t=ft(this,1,4).year;return null==e?t:this.add(e-t,"y")}function Pn(){return Mn(this.year(),1,4)}function Hn(){var e=this.localeData()._week;return Mn(this.year(),e.dow,e.doy)}function Bn(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}function jn(e,t){return"string"!=typeof e?e:isNaN(e)?(e=t.weekdaysParse(e),"number"==typeof e?e:null):parseInt(e,10)}function Fn(e){return this._weekdays[e.day()]}function In(e){return this._weekdaysShort[e.day()]}function qn(e){return this._weekdaysMin[e.day()]}function Rn(e){var t,n,r;for(this._weekdaysParse=this._weekdaysParse||[],t=0;7>t;t++)if(this._weekdaysParse[t]||(n=At([2e3,1]).day(t),r="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[t]=new RegExp(r.replace(".",""),"i")),this._weekdaysParse[t].test(e))return t}function Un(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=jn(e,this.localeData()),this.add(e-t,"d")):t}function zn(e){var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")}function Wn(e){return null==e?this.day()||7:this.day(this.day()%7?e:e-7)}function Xn(e,t){D(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function Vn(e,t){return t._meridiemParse}function $n(e){return"p"===(e+"").toLowerCase().charAt(0)}function Jn(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"}function Kn(e,t){t[hi]=m(1e3*("0."+e))}function Qn(){return this._isUTC?"UTC":""}function Gn(){return this._isUTC?"Coordinated Universal Time":""}function Yn(e){return At(1e3*e)}function Zn(){return At.apply(null,arguments).parseZone()}function er(e,t,n){var r=this._calendar[e];return"function"==typeof r?r.call(t,n):r}function tr(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])}function nr(){return this._invalidDate}function rr(e){return this._ordinal.replace("%d",e)}function ir(e){return e}function sr(e,t,n,r){var i=this._relativeTime[n];return"function"==typeof i?i(e,t,n,r):i.replace(/%d/i,e)}function or(e,t){var n=this._relativeTime[e>0?"future":"past"];return"function"==typeof n?n(t):n.replace(/%s/i,t)}function ur(e){var t,n;for(n in e)t=e[n],"function"==typeof t?this[n]=t:this["_"+n]=t;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)}function ar(e,t,n,r){var i=T(),s=u().set(r,t);return i[n](s,e)}function fr(e,t,n,r,i){if("number"==typeof e&&(t=e,e=void 0),e=e||"",null!=t)return ar(e,t,n,i);var s,o=[];for(s=0;r>s;s++)o[s]=ar(e,s,n,i);return o}function lr(e,t){return fr(e,t,"months",12,"month")}function cr(e,t){return fr(e,t,"monthsShort",12,"month")}function hr(e,t){return fr(e,t,"weekdays",7,"day")}function pr(e,t){return fr(e,t,"weekdaysShort",7,"day")}function dr(e,t){return fr(e,t,"weekdaysMin",7,"day")}function vr(){var e=this._data;return this._milliseconds=Ki(this._milliseconds),this._days=Ki(this._days),this._months=Ki(this._months),e.milliseconds=Ki(e.milliseconds),e.seconds=Ki(e.seconds),e.minutes=Ki(e.minutes),e.hours=Ki(e.hours),e.months=Ki(e.months),e.years=Ki(e.years),this}function mr(e,t,n,r){var i=Qt(t,n);return e._milliseconds+=r*i._milliseconds,e._days+=r*i._days,e._months+=r*i._months,e._bubble()}function gr(e,t){return mr(this,e,t,1)}function yr(e,t){return mr(this,e,t,-1)}function br(e){return 0>e?Math.floor(e):Math.ceil(e)}function wr(){var e,t,n,r,i,s=this._milliseconds,o=this._days,u=this._months,a=this._data;return s>=0&&o>=0&&u>=0||0>=s&&0>=o&&0>=u||(s+=864e5*br(Sr(u)+o),o=0,u=0),a.milliseconds=s%1e3,e=v(s/1e3),a.seconds=e%60,t=v(e/60),a.minutes=t%60,n=v(t/60),a.hours=n%24,o+=v(n/24),i=v(Er(o)),u+=i,o-=br(Sr(i)),r=v(u/12),u%=12,a.days=o,a.months=u,a.years=r,this}function Er(e){return 4800*e/146097}function Sr(e){return 146097*e/4800}function xr(e){var t,n,r=this._milliseconds;if(e=C(e),"month"===e||"year"===e)return t=this._days+r/864e5,n=this._months+Er(t),"month"===e?n:n/12;switch(t=this._days+Math.round(Sr(this._months)),e){case"week":return t/7+r/6048e5;case"day":return t+r/864e5;case"hour":return 24*t+r/36e5;case"minute":return 1440*t+r/6e4;case"second":return 86400*t+r/1e3;case"millisecond":return Math.floor(864e5*t)+r;default:throw new Error("Unknown unit "+e)}}function Tr(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*m(this._months/12)}function Nr(e){return function(){return this.as(e)}}function Cr(e){return e=C(e),this[e+"s"]()}function kr(e){return function(){return this._data[e]}}function Lr(){return v(this.days()/7)}function Ar(e,t,n,r,i){return i.relativeTime(t||1,!!n,e,r)}function Or(e,t,n){var r=Qt(e).abs(),i=cs(r.as("s")),s=cs(r.as("m")),o=cs(r.as("h")),u=cs(r.as("d")),a=cs(r.as("M")),f=cs(r.as("y")),l=i<hs.s&&["s",i]||1===s&&["m"]||s<hs.m&&["mm",s]||1===o&&["h"]||o<hs.h&&["hh",o]||1===u&&["d"]||u<hs.d&&["dd",u]||1===a&&["M"]||a<hs.M&&["MM",a]||1===f&&["y"]||["yy",f];return l[2]=t,l[3]=+e>0,l[4]=n,Ar.apply(null,l)}function Mr(e,t){return void 0===hs[e]?!1:void 0===t?hs[e]:(hs[e]=t,!0)}function _r(e){var t=this.localeData(),n=Or(this,!e,t);return e&&(n=t.pastFuture(+this,n)),t.postformat(n)}function Dr(){var e,t,n,r=ps(this._milliseconds)/1e3,i=ps(this._days),s=ps(this._months);e=v(r/60),t=v(e/60),r%=60,e%=60,n=v(s/12),s%=12;var o=n,u=s,a=i,f=t,l=e,c=r,h=this.asSeconds();return h?(0>h?"-":"")+"P"+(o?o+"Y":"")+(u?u+"M":"")+(a?a+"D":"")+(f||l||c?"T":"")+(f?f+"H":"")+(l?l+"M":"")+(c?c+"S":""):"P0D"}var Pr,Hr,Br=e.momentProperties=[],jr=!1,Fr={},Ir={},qr=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Rr=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Ur={},zr={},Wr=/\d/,Xr=/\d\d/,Vr=/\d{3}/,$r=/\d{4}/,Jr=/[+-]?\d{6}/,Kr=/\d\d?/,Qr=/\d{1,3}/,Gr=/\d{1,4}/,Yr=/[+-]?\d{1,6}/,Zr=/\d+/,ei=/[+-]?\d+/,ti=/Z|[+-]\d\d:?\d\d/gi,ni=/[+-]?\d+(\.\d{1,3})?/,ri=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,ii={},si={},oi=0,ui=1,ai=2,fi=3,li=4,ci=5,hi=6;D("M",["MM",2],"Mo",function(){return this.month()+1}),D("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),D("MMMM",0,0,function(e){return this.localeData().months(this,e)}),N("month","M"),I("M",Kr),I("MM",Kr,Xr),I("MMM",ri),I("MMMM",ri),U(["M","MM"],function(e,t){t[ui]=m(e)-1}),U(["MMM","MMMM"],function(e,t,n,r){var i=n._locale.monthsParse(e,r,n._strict);null!=i?t[ui]=i:f(n).invalidMonth=e});var pi="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),di="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),vi={};e.suppressDeprecationWarnings=!1;var mi=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,gi=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],yi=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],bi=/^\/?Date\((\-?\d+)/i;e.createFromInputFallback=et("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),D(0,["YY",2],0,function(){return this.year()%100}),D(0,["YYYY",4],0,"year"),D(0,["YYYYY",5],0,"year"),D(0,["YYYYYY",6,!0],0,"year"),N("year","y"),I("Y",ei),I("YY",Kr,Xr),I("YYYY",Gr,$r),I("YYYYY",Yr,Jr),I("YYYYYY",Yr,Jr),U(["YYYYY","YYYYYY"],oi),U("YYYY",function(t,n){n[oi]=2===t.length?e.parseTwoDigitYear(t):m(t)}),U("YY",function(t,n){n[oi]=e.parseTwoDigitYear(t)}),e.parseTwoDigitYear=function(e){return m(e)+(m(e)>68?1900:2e3)};var wi=L("FullYear",!1);D("w",["ww",2],"wo","week"),D("W",["WW",2],"Wo","isoWeek"),N("week","w"),N("isoWeek","W"),I("w",Kr),I("ww",Kr,Xr),I("W",Kr),I("WW",Kr,Xr),z(["w","ww","W","WW"],function(e,t,n,r){t[r.substr(0,1)]=m(e)});var Ei={dow:0,doy:6};D("DDD",["DDDD",3],"DDDo","dayOfYear"),N("dayOfYear","DDD"),I("DDD",Qr),I("DDDD",Vr),U(["DDD","DDDD"],function(e,t,n){n._dayOfYear=m(e)}),e.ISO_8601=function(){};var Si=et("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(){var e=At.apply(null,arguments);return this>e?this:e}),xi=et("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(){var e=At.apply(null,arguments);return e>this?this:e});Ht("Z",":"),Ht("ZZ",""),I("Z",ti),I("ZZ",ti),U(["Z","ZZ"],function(e,t,n){n._useUTC=!0,n._tzm=Bt(e)});var Ti=/([\+\-]|\d\d)/gi;e.updateOffset=function(){};var Ni=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,Ci=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/;Qt.fn=Dt.prototype;var ki=en(1,"add"),Li=en(-1,"subtract");e.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";var Ai=et("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});D(0,["gg",2],0,function(){return this.weekYear()%100}),D(0,["GG",2],0,function(){return this.isoWeekYear()%100}),On("gggg","weekYear"),On("ggggg","weekYear"),On("GGGG","isoWeekYear"),On("GGGGG","isoWeekYear"),N("weekYear","gg"),N("isoWeekYear","GG"),I("G",ei),I("g",ei),I("GG",Kr,Xr),I("gg",Kr,Xr),I("GGGG",Gr,$r),I("gggg",Gr,$r),I("GGGGG",Yr,Jr),I("ggggg",Yr,Jr),z(["gggg","ggggg","GGGG","GGGGG"],function(e,t,n,r){t[r.substr(0,2)]=m(e)}),z(["gg","GG"],function(t,n,r,i){n[i]=e.parseTwoDigitYear(t)}),D("Q",0,0,"quarter"),N("quarter","Q"),I("Q",Wr),U("Q",function(e,t){t[ui]=3*(m(e)-1)}),D("D",["DD",2],"Do","date"),N("date","D"),I("D",Kr),I("DD",Kr,Xr),I("Do",function(e,t){return e?t._ordinalParse:t._ordinalParseLenient}),U(["D","DD"],ai),U("Do",function(e,t){t[ai]=m(e.match(Kr)[0],10)});var Oi=L("Date",!0);D("d",0,"do","day"),D("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),D("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),D("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),D("e",0,0,"weekday"),D("E",0,0,"isoWeekday"),N("day","d"),N("weekday","e"),N("isoWeekday","E"),I("d",Kr),I("e",Kr),I("E",Kr),I("dd",ri),I("ddd",ri),I("dddd",ri),z(["dd","ddd","dddd"],function(e,t,n){var r=n._locale.weekdaysParse(e);null!=r?t.d=r:f(n).invalidWeekday=e}),z(["d","e","E"],function(e,t,n,r){t[r]=m(e)});var Mi="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),_i="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Di="Su_Mo_Tu_We_Th_Fr_Sa".split("_");D("H",["HH",2],0,"hour"),D("h",["hh",2],0,function(){return this.hours()%12||12}),Xn("a",!0),Xn("A",!1),N("hour","h"),I("a",Vn),I("A",Vn),I("H",Kr),I("h",Kr),I("HH",Kr,Xr),I("hh",Kr,Xr),U(["H","HH"],fi),U(["a","A"],function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e}),U(["h","hh"],function(e,t,n){t[fi]=m(e),f(n).bigHour=!0});var Pi=/[ap]\.?m?\.?/i,Hi=L("Hours",!0);D("m",["mm",2],0,"minute"),N("minute","m"),I("m",Kr),I("mm",Kr,Xr),U(["m","mm"],li);var Bi=L("Minutes",!1);D("s",["ss",2],0,"second"),N("second","s"),I("s",Kr),I("ss",Kr,Xr),U(["s","ss"],ci);var ji=L("Seconds",!1);D("S",0,0,function(){return~~(this.millisecond()/100)}),D(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),D(0,["SSS",3],0,"millisecond"),D(0,["SSSS",4],0,function(){return 10*this.millisecond()}),D(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),D(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),D(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),D(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),D(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),N("millisecond","ms"),I("S",Qr,Wr),I("SS",Qr,Xr),I("SSS",Qr,Vr);var Fi;for(Fi="SSSS";Fi.length<=9;Fi+="S")I(Fi,Zr);for(Fi="S";Fi.length<=9;Fi+="S")U(Fi,Kn);var Ii=L("Milliseconds",!1);D("z",0,0,"zoneAbbr"),D("zz",0,0,"zoneName");var qi=p.prototype;qi.add=ki,qi.calendar=nn,qi.clone=rn,qi.diff=fn,qi.endOf=En,qi.format=pn,qi.from=dn,qi.fromNow=vn,qi.to=mn,qi.toNow=gn,qi.get=M,qi.invalidAt=An,qi.isAfter=sn,qi.isBefore=on,qi.isBetween=un,qi.isSame=an,qi.isValid=kn,qi.lang=Ai,qi.locale=yn,qi.localeData=bn,qi.max=xi,qi.min=Si,qi.parsingFlags=Ln,qi.set=M,qi.startOf=wn,qi.subtract=Li,qi.toArray=Nn,qi.toObject=Cn,qi.toDate=Tn,qi.toISOString=hn,qi.toJSON=hn,qi.toString=cn,qi.unix=xn,qi.valueOf=Sn,qi.year=wi,qi.isLeapYear=at,qi.weekYear=_n,qi.isoWeekYear=Dn,qi.quarter=qi.quarters=Bn,qi.month=Q,qi.daysInMonth=G,qi.week=qi.weeks=pt,qi.isoWeek=qi.isoWeeks=dt,qi.weeksInYear=Hn,qi.isoWeeksInYear=Pn,qi.date=Oi,qi.day=qi.days=Un,qi.weekday=zn,qi.isoWeekday=Wn,qi.dayOfYear=mt,qi.hour=qi.hours=Hi,qi.minute=qi.minutes=Bi,qi.second=qi.seconds=ji,qi.millisecond=qi.milliseconds=Ii,qi.utcOffset=It,qi.utc=Rt,qi.local=Ut,qi.parseZone=zt,qi.hasAlignedHourOffset=Wt,qi.isDST=Xt,qi.isDSTShifted=Vt,qi.isLocal=$t,qi.isUtcOffset=Jt,qi.isUtc=Kt,qi.isUTC=Kt,qi.zoneAbbr=Qn,qi.zoneName=Gn,qi.dates=et("dates accessor is deprecated. Use date instead.",Oi),qi.months=et("months accessor is deprecated. Use month instead",Q),qi.years=et("years accessor is deprecated. Use year instead",wi),qi.zone=et("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",qt);var Ri=qi,Ui={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},zi={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},Wi="Invalid date",Xi="%d",Vi=/\d{1,2}/,$i={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},Ji=y.prototype;Ji._calendar=Ui,Ji.calendar=er,Ji._longDateFormat=zi,Ji.longDateFormat=tr,Ji._invalidDate=Wi,Ji.invalidDate=nr,Ji._ordinal=Xi,Ji.ordinal=rr,Ji._ordinalParse=Vi,Ji.preparse=ir,Ji.postformat=ir,Ji._relativeTime=$i,Ji.relativeTime=sr,Ji.pastFuture=or,Ji.set=ur,Ji.months=V,Ji._months=pi,Ji.monthsShort=$,Ji._monthsShort=di,Ji.monthsParse=J,Ji.week=lt,Ji._week=Ei,Ji.firstDayOfYear=ht,Ji.firstDayOfWeek=ct,Ji.weekdays=Fn,Ji._weekdays=Mi,Ji.weekdaysMin=qn,Ji._weekdaysMin=Di,Ji.weekdaysShort=In,Ji._weekdaysShort=_i,Ji.weekdaysParse=Rn,Ji.isPM=$n,Ji._meridiemParse=Pi,Ji.meridiem=Jn,S("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,n=1===m(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+n}}),e.lang=et("moment.lang is deprecated. Use moment.locale instead.",S),e.langData=et("moment.langData is deprecated. Use moment.localeData instead.",T);var Ki=Math.abs,Qi=Nr("ms"),Gi=Nr("s"),Yi=Nr("m"),Zi=Nr("h"),es=Nr("d"),ts=Nr("w"),ns=Nr("M"),rs=Nr("y"),is=kr("milliseconds"),ss=kr("seconds"),os=kr("minutes"),us=kr("hours"),as=kr("days"),fs=kr("months"),ls=kr("years"),cs=Math.round,hs={s:45,m:45,h:22,d:26,M:11},ps=Math.abs,ds=Dt.prototype;ds.abs=vr,ds.add=gr,ds.subtract=yr,ds.as=xr,ds.asMilliseconds=Qi,ds.asSeconds=Gi,ds.asMinutes=Yi,ds.asHours=Zi,ds.asDays=es,ds.asWeeks=ts,ds.asMonths=ns,ds.asYears=rs,ds.valueOf=Tr,ds._bubble=wr,ds.get=Cr,ds.milliseconds=is,ds.seconds=ss,ds.minutes=os,ds.hours=us,ds.days=as,ds.weeks=Lr,ds.months=fs,ds.years=ls,ds.humanize=_r,ds.toISOString=Dr,ds.toString=Dr,ds.toJSON=Dr,ds.locale=yn,ds.localeData=bn,ds.toIsoString=et("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Dr),ds.lang=Ai,D("X",0,0,"unix"),D("x",0,0,"valueOf"),I("x",ei),I("X",ni),U("X",function(e,t,n){n._d=new Date(1e3*parseFloat(e,10))}),U("x",function(e,t,n){n._d=new Date(m(e))}),e.version="2.10.6",t(At),e.fn=Ri,e.min=Mt,e.max=_t,e.utc=u,e.unix=Yn,e.months=lr,e.isDate=r,e.locale=S,e.invalid=c,e.duration=Qt,e.isMoment=d,e.weekdays=hr,e.parseZone=Zn,e.localeData=T,e.isDuration=Pt,e.monthsShort=cr,e.weekdaysMin=dr,e.defineLocale=x,e.weekdaysShort=pr,e.normalizeUnits=C,e.relativeTimeThreshold=Mr;var vs=e;return vs}),define("upload",["require","jquery","events","jade","identity","log"],function(e){function f(e,t){e.status_span.html(t)}function l(e,t){p(e);if(!t)return;this&&f(e,this),t&&t.error_message&&(t=t.error_message),y(e.progress,t),d(e,t)}function c(){var e=this;p(e),f(e,"")}function h(e){e.upload_input.prop("disabled",!0)}function p(e){e.upload_input.prop("disabled",!1)}function d(e,t){var n=e.error_span,r=typeof t=="object"?"Server Error":t;i.error("mark_error : err = ",t),n.html(r),n.css("display","block")}function v(e){e.error_span.html(""),e.error_span.css("display","none")}function m(e){var n=t.Deferred(),r=this,s=r.file;i.info("upload_start : presigned_response = ",e);var o=new XMLHttpRequest;return o.open("PUT",e.upload_url),o.setRequestHeader("x-amz-acl","public-read"),o.upload.addEventListener("progress",b.bind(null,r)),o.onload=function(){if(o.status!==200){n.reject("upload failed with status code "+o.status),y(r.progress,o.status);return}n.resolve(e,s),y(r.progress,null)},o.onerror=function(e){i.error("upload_start: err = ",e),f(r,"Upload Failed"),n.reject(e)},o.send(s),f(r,"Uploading ..."),n.promise()}function g(e){e.find(".progress-bar").removeClass("progress-bar-danger"),e.find(".progress-bar").removeClass("progress-bar-success"),e.find(".progress-bar").css("width","0%"),e.fadeIn(500)}function y(e,t){e.find(".progress-bar").addClass("progress-bar-"+(t?"danger":"success")),e.find(".progress-bar").removeClass("progress-bar-"+(t?"success":"danger")),e.fadeOut(500)}function b(e,t){if(t.lengthComputable===!0){var n=t.loaded/t.total*100;e.progress.find(".progress-bar").css("width",parseInt(t.loaded/t.total*100,10)+"%")}}function w(e,n){var r=t.Deferred(),i=this;f(i,"Finalizing upload ...");var s="upload_complete",u={name:n.name,path:"/vctemp/"+encodeURIComponent(n.name),type:n.type,size:n.size,url:e.access_url,user_id:i.email,vc_id:o.identity.vc_id,u_name:o.identity.id,removeafter:3600,tags:"content, pdf"};return i.busy.css("display","block"),o.send_command(null,s,u,0).then(function(t){r.resolve(e,t)},function(e){r.reject(e),f(i,"Upload Complete Info Error.")}),r.promise()}function E(e,n){var r=t.Deferred(),i=this;f(i,"Processing ...");var s="start-conversion",u={name:n.name,path:"/"+encodeURIComponent(n.name),type:n.type,size:n.size,url:e.access_url,user_id:i.email,vc_id:o.identity.vc_id,u_name:o.identity.id,tags:"content, pdf"};return i.busy.css("display","block"),o.send_command(null,s,u,0).then(function(t){r.resolve(e,t),f(i,"Conversion Finished")},function(e){r.reject(e),f(i,"Conversion Failed")}).always(function(){i.busy.css("display","none")}),r.promise()}function S(e,n,r){var s=t.Deferred();return i.info("inform_library : ",e,n,r),a.emit("content-added",{handle:e.handle,data:r}),s.resolve(),s.promise()}function x(){}function T(e){var t=e.file,n="get-tmp-url",r={path:"/vctemp/"+encodeURIComponent(t.name),name:t.name,type:t.type?t.type:t.name.replace(/^.*\./g,""),user_id:e.email};return i.info("get_presigned_url: sending ",r),o.send_command(null,n,r,0)}var t=e("jquery"),n=e("events");window.jade=e("jade");var r=e("identity"),i=e("log")("upload","info"),s={},o,u,a=n.emitter("content:upload","upload");return s.init=function(e,t,n,r){return o=r,u=r.perms.has_perm,x(),!0},s.prepare=function(e){var n={};n.handle=e.handle,n.anchor=e.anchor,n.email=e.email,n.upload_span=n.anchor.find(".content-upload-label"),n.upload_input=n.anchor.find(".content-upload-input"),n.error_span=n.anchor.find(".content-upload-error"),n.status_span=n.anchor.find(".content-upload-status"),n.progress=n.anchor.find(".progress"),n.busy=n.anchor.find(".content-conversion-busy"),n.upload_span.on("click",function(e){n.upload_input.trigger("click")}),n.upload_input.on("click",function(e){if(!u("write","control"))return!1;v(n),f(n,""),n.upload_input.val(null)}),n.upload_input.on("change",function(r){var i=t(r.currentTarget)[0].files;if(!i||i.length===0)return;h(n),g(n.progress),f(n,"Requesting ..."),n.file=i[0],T(n).then(m.bind(n),l.bind("Request Failed",n)).then(w.bind(n),l.bind("Upload Failed",n)).then(E.bind(n),l.bind("Upload Failed",n)).then(S.bind(n,e),l.bind("Conversion Failed",n)).then(c.bind(n),l.bind("Post Conversion Failed",n))}),n.upload_input.attr("accept",".pdf, .doc, .docx, .ppt, .pptx, .xls, .xlsx, .txt")},s}),define("library",["require","jquery","events","moment","scrollbar","jade","log","./upload","./player"],function(e){function p(e,t){m(e).then(y.bind(t),v.bind(t)).then(d.bind(t))}function d(){var e=this;e.find("span.busy").fadeOut()}function v(e){for(var t in h){var n=h[t].$lib_main;n.find(".busy").css("display","none"),n.find(".content-lib-error").css("display","inline").html(e)}}function m(e){var t="get-content",n={user_id:e};return f.send_command(null,t,n,0)}function y(e){var t=this;e.data=b(e.data);for(var n=0;n<e.data.length;n++){var r=e.data[n];if(r.path.startsWith("/vctemp/"))continue;w(t,r),g[r.url]=r}}function b(e){try{e.sort(function(e,t){var n=r(e.ctime),i=r(t.ctime),s=r.duration(n.diff(i));return s}),s.log("library sorted")}catch(t){s.error({err:t},"library sort failed")}return e}function w(e,t){var n=f.template("library-item"),r=n(t);e.find(".content-lib-items ul").prepend(r)}function E(){t("#widget-tabs").on("click","div.content-item-thumbnail",S)}function S(e){if(!l("write","control"))return;var n=t(e.currentTarget).closest(".content-lib-main"),r=t(e.currentTarget).closest(".content-lib-outer").attr("data-uuid"),i=n.attr("data-tab-anchor-id"),o=n.closest("#"+i)[0],a=t(e.currentTarget).find("a.content-preview-trigger").attr("data-content-url");if(!g[a])return s.error("no file details found against this url: ",a),!1;u.start(h[r].handle,g[a],{mode:"preview"})}function x(e,t){switch(e){case"content-added":var n=t.handle,r=t.data;for(var i in h){var o=h[i].$lib_main;w(o,r),g[r.url]=r}u.start(n,r,{mode:"preview"});break;default:s.error('unknown event "'+e+'". possibly a bug in the code. ignoring.')}}function T(e){var t=e.find(".content-lib-items");t.perfectScrollbar(),t.resize(function(e){t.perfectScrollbar("update")})}var t=e("jquery"),n=e("events"),r=e("moment"),i=e("scrollbar");window.jade=e("jade");var s=e("log")("library","info"),o=e("./upload"),u=e("./player"),a={},f,l,c={},h={};n.bind("content:upload",x,"library"),a.init=function(e,t,n,r){return f=r,l=r.perms.has_perm,E(),!0},a.start=function(e){var n=e.anchor,r=t(n).attr("id"),i=t.Deferred(),u=f.identity.emails,a=f.identity.id,l=f.identity.auth_via,c=u&&u[0].value,d=f.identity.displayName||c||"unknown";switch(l){case"anon":c="test@wiziq.com";break;default:c=a+"@"+l+".com"}d=l!=="anon"?d:"Public",s.info({name:d,email:c},"content user info being used");var v=f.template("library");t(n).append(v({tab_anchor_id:r,uuid:e.uuid,email:d})),o.prepare({handle:e,anchor:t(n).find(".content-lib-upload"),email:c});var m=t(n).find(".content-lib-main");return T(m),p(c,m),h[e.uuid]={handle:e,$lib_main:m},i.resolve(),i.promise()},a.destroy=function(e){var t=e.find(".content-lib-outer");if(!t||!t.length)return;var n=t.attr("data-uuid");n||s.error("destroy () : unable to find UUID for",e),n&&delete h[n],e.find(".content-lib-outer").empty()};var g={};return a}),define("content",["require","jquery","jade","log","events","framework","./pointer","./player","./library","./upload"],function(e){function p(e,t,r,i){var u={uuid:e.uuid,owner:e.owner,startup:e.startup||!1,is_remote_command:e.is_remote_command},a=l.tabs.get_by_uuid(e.uuid)||{},f=a.handle;f||(f=l.tabs.create(u)),u={mode:"fullview",scroll_info:r},l.tabs.sync_remote({uuid:e.uuid,quiet:!0}),o.start(f,t,u).then(function(t){s.register(t.viewer,e.uuid,e.is_remote_command),i&&(n.info("got pointer_info",i),s.info(i))},function(e){n.error("unable to start player for ",t," - reason : ",e)})}function d(e){var t=l.tabs.get_by_uuid(e.uuid)||{},r=t.handle;if(!r){n.error("rx remote navigation for non-existent tab : uuid = "+e.uuid);return}o.navigate(e.uuid,r.anchor,e)}function v(e){var t=l.tabs.get_by_uuid(e.uuid)||{},r=t.handle;if(!r){n.error("rx remote scroll for non-existent tab : uuid = "+e.uuid);return}o.scroll_to(e.uuid,r.anchor,e)}function m(e){var t={create:f.create,destroy:f.destroy,now_showing:f.now_showing,now_hidden:f.now_hidden},n={display_name:"Content",add_to_dropdown:!0};return{name:e,handle:t,options:n}}function g(e,t){if(e!=="override")return;t.key==="write"&&t.subkey==="control"&&h.then(y(t.val))}function y(e){var n,r=e?"yes":"no",i=t('ul.nav.nav-tabs li[data-mod-name="content"]');i.each(function(r){var i=t(this);i.hasClass("tab-is-shared")&&(n=i.attr("data-tab-uuid"),o.set_enabled(e,n))});if(!e){var s=t("#widget-tabs ul.nav li.active");n=l.tabs.get_active();if(!s.hasClass("tab-is-shared")){var u=!1;l.tabs.show({uuid:n},u)}}}var t=e("jquery");window.jade=e("jade");var n=e("log")("content","info"),r=e("events"),i=e("framework"),s=e("./pointer"),o=e("./player"),u=e("./library"),a=e("./upload"),f={},l=i.handle("content"),c=l.perms.has_perm;f.init=function(e,i,f,c){var h=t.Deferred(),p=m(c);return n.info({register_info:p},"content register info"),l.tabs.register(p),u.init(e,i,f,l)?a.init(e,i,f,l)?o.init(e,i,f,l)?(s.init(l),r.bind("framework:perms",g,"content"),h.resolve(),h.promise()):(h.reject("content player init failed"),h.promise()):(h.reject("content upload init failed"),h.promise()):(h.reject("content library init failed"),h.promise())},f.info=function(e,t,r,i){switch(t){case"new-content":var o={uuid:r.uuid,owner:r.owner,is_remote_command:!0};return p(o,r.doc_info,r.scroll_info);case"navigate-to":return d(r);case"scroll-to":return v(r);case"pointer-event":return s.info(r);default:n.error("received unknown info_id ("+t+"). Ignoring.");return}};var h=t.Deferred();return f.start=function(e){n.info("sess_info = ",e);for(var t in e.shared){var r=l.identity.vc_id,i=e.shared[t].owner;i===r&&f.create({uuid:t,startup:!0});var s=e.shared[t];p({uuid:t,owner:i,startup:!0},s.doc_info,s.scroll_info,s.pointer)}h.resolve();return},f.create=function(e){if(!c("write","control"))return;var t=l.tabs.create(e),r=t.uuid;return r||n.error("create called, but no UUID specified"),u.start(t)},f.destroy=function(e,t,r){n.info("content.destroy: $tab_anchor",e,"uuid = "+t),o.destroy(e,t,r),u.destroy(e,t,r),s.destroy(e,t,r)},f.now_showing=function(e){o.now_showing({$tab_anchor:e.handle.anchor,id:e.handle.id,uuid:e.handle.uuid}),s.nowshowing(e.handle.uuid)},f.now_hidden=function(e){o.now_hidden({$tab_anchor:e.handle.anchor,id:e.handle.id,uuid:e.handle.uuid})},f}),require([""]);