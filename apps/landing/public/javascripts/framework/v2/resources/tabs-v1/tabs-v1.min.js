define("tabs-v1",["require","jquery","jade","modernizer","log","events","framework","bootstrap"],function(e){function y(){c.on("click","a.tab-menu",function(e){var n=t(e.currentTarget).attr("href"),r=n.replace(/^#tab-menu-/g,"");m[r]&&m[r].methods&&m[r].methods.create(),e.preventDefault()}),h.on("click","a.tab-close",function(e){var n=t(e.currentTarget).closest("li"),r=n.attr("data-tab-uuid"),i=a.tabs.get_by_uuid(r)||{};return f("write","control",i.owner)&&b({uuid:r}),!0}),h.on("shown.bs.tab",'a[data-toggle="tab"]',function(e){var n=t(e.target).closest("li").attr("data-tab-uuid"),r=t(e.target).data("iscommand");a.tabs.now_showing({uuid:n},r),t(e.target).data("iscommand",!1)}),h.on("hidden.bs.tab",'a[data-toggle="tab"]',function(e){var n=t(e.target).closest("li").attr("data-tab-uuid");a.tabs.now_hidden({uuid:n})}),h.on("click",".tab-name a.tab-name",function(e){if(t(this).hasClass("disabled"))return!1}),h.on("click",".tab-dropdown a.dropdown-toggle",function(e){if(t(this).hasClass("disabled"))return!1})}function b(e,t){var n=e.uuid,r=h.find("li[data-tab-uuid="+n+"]"),i=r.attr("data-mod-name"),s=r.find("a.tab-name").attr("aria-controls"),o=p.find("div#"+s+".tab-pane");if(!t){var f=a.tabs.get_active();e.uuid_next=f==n?w(r):f}u.show({uuid:e.uuid_next},t),r.remove(),setTimeout(function(){m[i]&&m[i].methods&&m[i].methods.destroy(o,n,t),o.empty(),o.remove()},1e3),a.tabs.destroyed(e,t);return}function w(e){var t=e.next();while(t.length&&!t.hasClass("tab-is-shared"))t=t.next();if(!t||!t.length)t=e.prev();while(!t.hasClass("tab-is-shared")&&!t.hasClass("add"))t=t.prev();return t.hasClass("add")&&(t=e.next(),t.length||(t=e.prev())),t.attr("data-tab-uuid")}function E(e,n){var r=n.display_name||e;t(c).prevAll("a.dropdown-toggle").prop("disabled",!1),t(c).prevAll("a.dropdown-toggle").removeClass("read-only"),c.append('<li><a class="tab-menu" href="#tab-menu-'+e+'">'+r+"</a>"+"</li>")}function S(){t(c).prevAll("a.dropdown-toggle").prop("disabled",!0),t(c).prevAll("a.dropdown-toggle").addClass("read-only")}function x(e,t){if(e!=="override")return;t.key==="write"&&t.subkey==="control"&&u.set_enabled(t.val);return}var t=e("jquery");window.jade=e("jade");var n=e("modernizer"),r=e("log")("tabs-v1","info"),i=e("events"),s=e("framework"),o=e("bootstrap"),u={},a=s.handle("tabs-v1"),f=a.perms.has_perm,l,c,h,p,d,v,m={};u.init=function(e,n,r){var s=t.Deferred();l=e.anchor;var o=a.template("tabs");return d=a.template("tabs-li"),v=a.template("tabs-tabpanel"),!o||!d||!v?(s.reject("tabs-v1: one or more templates not found"),s.promise()):(t(l).append(o()),c=t(l).find("ul.dropdown-menu"),h=t(l).find("ul.nav.nav-tabs"),p=t(l).find("div.tab-content"),y(),i.bind("framework:perms",x,"tabs"),s.resolve(),s.promise())},u.register=function(e,n,i){return m[e]={methods:n},i.add_to_dropdown&&(r.info(" added to dropdown"),E(e,i)),t(c).find("li").length===0&&(r.info("dropdown empty"),S()),null},u.start=function(e){};var g=0;return u.create=function(e,t){var n=e+g,r=t.display_name?t.display_name:e+"("+g+")";g++,t.active&&(h.find("li.active").removeClass("active"),p.find("div.active").removeClass("active")),t.disable_close=!1,h.append(d({id:n,display_name:r,uuid:t.uuid,owner:t.owner,disable_close:t.disable_close,module_name:e,active:t.active})),p.append(v({id:n,uuid:t.uuid,active:t.active}));var i={anchor:p.find("div.tab-pane#"+n)[0],id:n,uuid:t.uuid,owner:t.owner};return h.find("li a#"+n).tab("show"),f("write","control")||h.find("li[role=presentation] .tab-name a.tab-name").addClass("disabled"),i},u.destroy=function(e,t){var n=e.uuid;b(e,t)},u.set_enabled=function(e){var t;t=e?"removeClass":"addClass",h.find("li.add .tab-dropdown a.dropdown-toggle")[t]("disabled"),h.find("li[role=presentation]")[t]("disabled"),h.find("li[role=presentation] .tab-name a.tab-name")[t]("disabled")},u.sync_remote=function(e){var t=e.uuid,n=h.find("li[data-tab-uuid="+t+"]");n.addClass("tab-is-shared")},u.set_tooltip=function(e,t){if(!t.html)return!1;var n=e.handle.uuid,r=h.find('li[data-tab-uuid="'+n+'"]'),i=r.find("div.tooltip-content");i.append(t.html),i.addClass("active")},u.is_active=function(e){var t=e.handle.uuid,n=h.find('li[data-tab-uuid="'+t+'"]');return n.hasClass("active")?!0:!1},u.set_title=function(e,t){var n=e.handle.uuid;t&&(h.find('li[data-tab-uuid="'+n+'"] a[role="tab"]').html(t),h.find('li[data-tab-uuid="'+n+'"]').attr("title",t));return},u.get_title=function(e){var t=e.handle.uuid,n=h.find('li[data-tab-uuid="'+t+'"] a[role="tab"]').html();return n},u.show=function(e,n){var r=e.uuid,i=t('li[data-tab-uuid="'+r+'"]');if(i.hasClass("active"))return;if(!i||!i.length){var s=h.find("li.add");s.find('a[data-toggle="tab"]').trigger("click");return}t('li[data-tab-uuid="'+r+'"] a').data("iscommand",n),t('li[data-tab-uuid="'+r+'"] a').tab("show")},u}),require([""]);